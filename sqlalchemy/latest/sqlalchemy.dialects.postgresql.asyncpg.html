<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
          "DTD/xhtml1-strict.dtd">
<html>
  

  <head>
    
    <title>sqlalchemy.dialects.postgresql.asyncpg</title>
    <meta name="generator" content="pydoctor 22.2.0"> 
        
    </meta>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=0.75" />
    <link rel="stylesheet" type="text/css" href="bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="apidocs.css" />
    <link rel="stylesheet" type="text/css" href="extra.css" />
</head>

  <body>

    

    <nav class="navbar navbar-default">
  
  <div class="container">

    <div class="navbar-header">
      
      <div class="navlinks">
          <span class="navbar-brand">
            sqlalchemy <a href="index.html">API Documentation</a>
          </span>

          <a href="moduleIndex.html">
            Modules
          </a>

          <a href="classIndex.html">
            Classes
          </a>

          <a href="nameIndex.html">
            Names
          </a>
      </div>

    </div>
  </div>
</nav>

    

    <div class="container">

      <div class="page-header">
        <h1 class="module"><code><code><a href="index.html" class="internal-link">sqlalchemy</a></code><wbr></wbr>.<code><a href="sqlalchemy.dialects.html" class="internal-link" title="sqlalchemy.dialects">dialects</a></code><wbr></wbr>.<code><a href="sqlalchemy.dialects.postgresql.html" class="internal-link" title="sqlalchemy.dialects.postgresql">postgresql</a></code><wbr></wbr>.<code><a href="sqlalchemy.dialects.postgresql.asyncpg.html" class="internal-link" title="sqlalchemy.dialects.postgresql.asyncpg">asyncpg</a></code></code></h1>
        <div id="showPrivate">
          <button class="btn btn-link" onclick="togglePrivate()">Toggle Private API</button>
        </div>
      </div>

      <div class="categoryHeader">
        module documentation
      </div>

      <div class="extrasDocstring">
        
        <p></p>
      </div>

      <div class="moduleDocstring">
        <div><p>The asyncpg dialect is SQLAlchemy's first Python asyncio dialect.</p>
<p>Using a special asyncio mediation layer, the asyncpg dialect is usable
as the backend for the <a href="#system-message-1"><span class="rst-problematic" id="rst-problematic-1">:ref:`SQLAlchemy asyncio &lt;asyncio_toplevel&gt;`</span></a>
extension package.</p>
<p>This dialect should normally be used only with the
<code>_asyncio.create_async_engine</code> engine creation function:</p>
<pre class="rst-literal-block">
from sqlalchemy.ext.asyncio import create_async_engine
engine = create_async_engine("postgresql+asyncpg://user:pass@hostname/dbname")
</pre>
<p>The dialect can also be run as a "synchronous" dialect within the
<code>_sa.create_engine</code> function, which will pass "await" calls into
an ad-hoc event loop.  This mode of operation is of <strong>limited use</strong>
and is for special testing scenarios only.  The mode can be enabled by
adding the SQLAlchemy-specific flag <tt class="rst-docutils literal">async_fallback</tt> to the URL
in conjunction with <code>_sa.create_engine</code>:</p>
<pre class="rst-literal-block">
# for testing purposes only; do not use in production!
engine = create_engine("postgresql+asyncpg://user:pass@hostname/dbname?async_fallback=true")
</pre>
<div class="rst-versionadded">
<span class="rst-versionmodified rst-added">New in version 1.4.</span></div>
<div class="rst-admonition note">
<p class="rst-first rst-admonition-title">Note</p>
<p class="rst-last">By default asyncpg does not decode the <tt class="rst-docutils literal">json</tt> and <tt class="rst-docutils literal">jsonb</tt> types and
returns them as strings. SQLAlchemy sets default type decoder for <tt class="rst-docutils literal">json</tt>
and <tt class="rst-docutils literal">jsonb</tt> types using the python builtin <tt class="rst-docutils literal">json.loads</tt> function.
The json implementation used can be changed by setting the attribute
<tt class="rst-docutils literal">json_deserializer</tt> when creating the engine with
<code>create_engine</code> or <code><a href="sqlalchemy.ext.asyncio.engine.html#create_async_engine" class="internal-link" title="sqlalchemy.ext.asyncio.engine.create_async_engine">create_async_engine</a></code>.</p>
</div>
<div class="rst-section" id="rst-prepared-statement-cache">
<span id="rst-asyncpg-prepared-statement-cache"></span><h2 class="heading">Prepared Statement Cache</h2>
<p>The asyncpg SQLAlchemy dialect makes use of <tt class="rst-docutils literal">asyncpg.connection.prepare()</tt>
for all statements.   The prepared statement objects are cached after
construction which appears to grant a 10% or more performance improvement for
statement invocation.   The cache is on a per-DBAPI connection basis, which
means that the primary storage for prepared statements is within DBAPI
connections pooled within the connection pool.   The size of this cache
defaults to 100 statements per DBAPI connection and may be adjusted using the
<tt class="rst-docutils literal">prepared_statement_cache_size</tt> DBAPI argument (note that while this argument
is implemented by SQLAlchemy, it is part of the DBAPI emulation portion of the
asyncpg dialect, therefore is handled as a DBAPI argument, not a dialect
argument):</p>
<pre class="rst-literal-block">
engine = create_async_engine("postgresql+asyncpg://user:pass@hostname/dbname?prepared_statement_cache_size=500")
</pre>
<p>To disable the prepared statement cache, use a value of zero:</p>
<pre class="rst-literal-block">
engine = create_async_engine("postgresql+asyncpg://user:pass@hostname/dbname?prepared_statement_cache_size=0")
</pre>
<div class="rst-versionadded">
<span class="rst-versionmodified rst-added">New in version 1.4.0b2: </span><span>Added <tt class="rst-docutils literal">prepared_statement_cache_size</tt> for asyncpg.</span></div>
<div class="rst-admonition warning">
<p class="rst-first rst-admonition-title">Warning</p>
<p>The <tt class="rst-docutils literal">asyncpg</tt> database driver necessarily uses caches for
PostgreSQL type OIDs, which become stale when custom PostgreSQL datatypes
such as <tt class="rst-docutils literal">ENUM</tt> objects are changed via DDL operations.   Additionally,
prepared statements themselves which are optionally cached by SQLAlchemy's
driver as described above may also become "stale" when DDL has been emitted
to the PostgreSQL database which modifies the tables or other objects
involved in a particular prepared statement.</p>
<p class="rst-last">The SQLAlchemy asyncpg dialect will invalidate these caches within its local
process when statements that represent DDL are emitted on a local
connection, but this is only controllable within a single Python process /
database engine.     If DDL changes are made from other database engines
and/or processes, a running application may encounter asyncpg exceptions
<tt class="rst-docutils literal">InvalidCachedStatementError</tt> and/or <tt class="rst-docutils literal"><span class="pre">InternalServerError("cache</span> lookup
failed for type <span class="pre">&lt;oid&gt;")</span></tt> if it refers to pooled database connections which
operated upon the previous structures. The SQLAlchemy asyncpg dialect will
recover from these error cases when the driver raises these exceptions by
clearing its internal caches as well as those of the asyncpg driver in
response to them, but cannot prevent them from being raised in the first
place if the cached prepared statement or asyncpg type caches have gone
stale, nor can it retry the statement as the PostgreSQL transaction is
invalidated when these errors occur.</p>
</div>
</div>
</div>
      </div>

      <div id="splitTables">
        <table class="children sortable" id="id15382">
  
  
  <tr class="class">
    
    <td>Class</td>
    <td><code><a href="sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_connection.html" class="internal-link" title="sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_connection">​Async​Adapt_asyncpg_connection</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><code><a href="sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor.html" class="internal-link" title="sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_cursor">​Async​Adapt_asyncpg_cursor</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><code><a href="sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.html" class="internal-link" title="sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi">​Async​Adapt_asyncpg_dbapi</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><code><a href="sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_ss_cursor.html" class="internal-link" title="sqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_ss_cursor">​Async​Adapt_asyncpg_ss_cursor</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><code><a href="sqlalchemy.dialects.postgresql.asyncpg.AsyncAdaptFallback_asyncpg_connection.html" class="internal-link" title="sqlalchemy.dialects.postgresql.asyncpg.AsyncAdaptFallback_asyncpg_connection">​Async​Adapt​Fallback_asyncpg_connection</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><code><a href="sqlalchemy.dialects.postgresql.asyncpg.AsyncpgBigInteger.html" class="internal-link" title="sqlalchemy.dialects.postgresql.asyncpg.AsyncpgBigInteger">​Asyncpg​Big​Integer</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><code><a href="sqlalchemy.dialects.postgresql.asyncpg.AsyncpgBoolean.html" class="internal-link" title="sqlalchemy.dialects.postgresql.asyncpg.AsyncpgBoolean">​Asyncpg​Boolean</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><code><a href="sqlalchemy.dialects.postgresql.asyncpg.AsyncpgDate.html" class="internal-link" title="sqlalchemy.dialects.postgresql.asyncpg.AsyncpgDate">​Asyncpg​Date</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><code><a href="sqlalchemy.dialects.postgresql.asyncpg.AsyncpgDateTime.html" class="internal-link" title="sqlalchemy.dialects.postgresql.asyncpg.AsyncpgDateTime">​Asyncpg​Date​Time</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><code><a href="sqlalchemy.dialects.postgresql.asyncpg.AsyncPgEnum.html" class="internal-link" title="sqlalchemy.dialects.postgresql.asyncpg.AsyncPgEnum">​Async​Pg​Enum</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><code><a href="sqlalchemy.dialects.postgresql.asyncpg.AsyncpgFloat.html" class="internal-link" title="sqlalchemy.dialects.postgresql.asyncpg.AsyncpgFloat">​Asyncpg​Float</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><code><a href="sqlalchemy.dialects.postgresql.asyncpg.AsyncpgInteger.html" class="internal-link" title="sqlalchemy.dialects.postgresql.asyncpg.AsyncpgInteger">​Asyncpg​Integer</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><code><a href="sqlalchemy.dialects.postgresql.asyncpg.AsyncPgInterval.html" class="internal-link" title="sqlalchemy.dialects.postgresql.asyncpg.AsyncPgInterval">​Async​Pg​Interval</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><code><a href="sqlalchemy.dialects.postgresql.asyncpg.AsyncpgJSON.html" class="internal-link" title="sqlalchemy.dialects.postgresql.asyncpg.AsyncpgJSON">​Asyncpg​JSON</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><code><a href="sqlalchemy.dialects.postgresql.asyncpg.AsyncpgJSONB.html" class="internal-link" title="sqlalchemy.dialects.postgresql.asyncpg.AsyncpgJSONB">​Asyncpg​JSONB</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><code><a href="sqlalchemy.dialects.postgresql.asyncpg.AsyncpgJSONIndexType.html" class="internal-link" title="sqlalchemy.dialects.postgresql.asyncpg.AsyncpgJSONIndexType">​Asyncpg​JSONIndex​Type</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><code><a href="sqlalchemy.dialects.postgresql.asyncpg.AsyncpgJSONIntIndexType.html" class="internal-link" title="sqlalchemy.dialects.postgresql.asyncpg.AsyncpgJSONIntIndexType">​Asyncpg​JSONInt​Index​Type</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><code><a href="sqlalchemy.dialects.postgresql.asyncpg.AsyncpgJSONPathType.html" class="internal-link" title="sqlalchemy.dialects.postgresql.asyncpg.AsyncpgJSONPathType">​Asyncpg​JSONPath​Type</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><code><a href="sqlalchemy.dialects.postgresql.asyncpg.AsyncpgJSONStrIndexType.html" class="internal-link" title="sqlalchemy.dialects.postgresql.asyncpg.AsyncpgJSONStrIndexType">​Asyncpg​JSONStr​Index​Type</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><code><a href="sqlalchemy.dialects.postgresql.asyncpg.AsyncpgNumeric.html" class="internal-link" title="sqlalchemy.dialects.postgresql.asyncpg.AsyncpgNumeric">​Asyncpg​Numeric</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><code><a href="sqlalchemy.dialects.postgresql.asyncpg.AsyncpgOID.html" class="internal-link" title="sqlalchemy.dialects.postgresql.asyncpg.AsyncpgOID">​Asyncpg​OID</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><code><a href="sqlalchemy.dialects.postgresql.asyncpg.AsyncpgREGCLASS.html" class="internal-link" title="sqlalchemy.dialects.postgresql.asyncpg.AsyncpgREGCLASS">​Asyncpg​REGCLASS</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><code><a href="sqlalchemy.dialects.postgresql.asyncpg.AsyncpgTime.html" class="internal-link" title="sqlalchemy.dialects.postgresql.asyncpg.AsyncpgTime">​Asyncpg​Time</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><code><a href="sqlalchemy.dialects.postgresql.asyncpg.AsyncpgUUID.html" class="internal-link" title="sqlalchemy.dialects.postgresql.asyncpg.AsyncpgUUID">​Asyncpg​UUID</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><code><a href="sqlalchemy.dialects.postgresql.asyncpg.PGCompiler_asyncpg.html" class="internal-link" title="sqlalchemy.dialects.postgresql.asyncpg.PGCompiler_asyncpg">​PGCompiler_asyncpg</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><code><a href="sqlalchemy.dialects.postgresql.asyncpg.PGDialect_asyncpg.html" class="internal-link" title="sqlalchemy.dialects.postgresql.asyncpg.PGDialect_asyncpg">​PGDialect_asyncpg</a></code></td>
    <td><span class="undocumented">No class docstring; 0/2 property, 0/1 instance variable, 0/11 class variable, 3/13 methods, 0/2 class method documented</span></td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><code><a href="sqlalchemy.dialects.postgresql.asyncpg.PGExecutionContext_asyncpg.html" class="internal-link" title="sqlalchemy.dialects.postgresql.asyncpg.PGExecutionContext_asyncpg">​PGExecution​Context_asyncpg</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><code><a href="sqlalchemy.dialects.postgresql.asyncpg.PGIdentifierPreparer_asyncpg.html" class="internal-link" title="sqlalchemy.dialects.postgresql.asyncpg.PGIdentifierPreparer_asyncpg">​PGIdentifier​Preparer_asyncpg</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="variable private">
    
    <td>Variable</td>
    <td><code><a href="#_pg_types" class="internal-link" title="sqlalchemy.dialects.postgresql.asyncpg._pg_types">​_pg​_types</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="variable private">
    
    <td>Variable</td>
    <td><code><a href="#_python_UUID" class="internal-link" title="sqlalchemy.dialects.postgresql.asyncpg._python_UUID">_python_​UUID</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr>
</table>
        

          
      </div>

      <div id="childList">

        <div class="basevariable private">
  
  
  <a name="sqlalchemy.dialects.postgresql.asyncpg._pg_types">
    
  </a>
  <a name="_pg_types">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">_pg_types</span> =
    
  </div>
  <div class="functionBody">
    
    
    <div><p class="undocumented">Undocumented</p></div>
    
  </div>
</div><div class="basevariable private">
  
  
  <a name="sqlalchemy.dialects.postgresql.asyncpg._python_UUID">
    
  </a>
  <a name="_python_UUID">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">_python_UUID</span> =
    
  </div>
  <div class="functionBody">
    
    
    <div><p class="undocumented">Undocumented</p></div>
    
  </div>
</div>

      </div>
    </div>

    <footer class="navbar navbar-default">
  
  <div class="container">
    <a href="index.html">API Documentation</a> for sqlalchemy,
  generated by <a href="https://github.com/twisted/pydoctor/">pydoctor</a>
    22.2.0 at 2022-02-23 04:41:59.
  </div>
</footer>

    <script src="pydoctor.js" type="text/javascript"></script>

  </body>
</html>