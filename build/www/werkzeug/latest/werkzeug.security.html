<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
          "DTD/xhtml1-strict.dtd">
<html>
  

  <head>
    
    <title>werkzeug.security</title>
    <meta name="generator" content="pydoctor 22.2.0"> 
        
    </meta>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=0.75" />
    <link rel="stylesheet" type="text/css" href="bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="apidocs.css" />
    <link rel="stylesheet" type="text/css" href="extra.css" />
</head>

  <body>

    

    <nav class="navbar navbar-default">
  
  <div class="container">

    <div class="navbar-header">
      
      <div class="navlinks">
          <span class="navbar-brand">
            werkzeug <a href="index.html">API Documentation</a>
          </span>

          <a href="moduleIndex.html">
            Modules
          </a>

          <a href="classIndex.html">
            Classes
          </a>

          <a href="nameIndex.html">
            Names
          </a>
      </div>

    </div>
  </div>
</nav>

    

    <div class="container">

      <div class="page-header">
        <h1 class="module"><code><code><a href="index.html" class="internal-link">werkzeug</a></code><wbr></wbr>.<code><a href="werkzeug.security.html" class="internal-link" title="werkzeug.security">security</a></code></code></h1>
        <div id="showPrivate">
          <button class="btn btn-link" onclick="togglePrivate()">Toggle Private API</button>
        </div>
      </div>

      <div class="categoryHeader">
        module documentation
      </div>

      <div class="extrasDocstring">
        
        <p></p>
      </div>

      <div class="moduleDocstring">
        <div><p class="undocumented">Undocumented</p></div>
      </div>

      <div id="splitTables">
        <table class="children sortable" id="id21794">
  
  
  <tr class="function">
    
    <td>Function</td>
    <td><code><a href="#check_password_hash" class="internal-link" title="werkzeug.security.check_password_hash">check​_password​_hash</a></code></td>
    <td>Check a password against a given salted and hashed password value. In order to support unsalted legacy passwords this method supports plain text passwords, md5 and sha1 hashes (both salted and unsalted).</td>
  </tr><tr class="function">
    
    <td>Function</td>
    <td><code><a href="#gen_salt" class="internal-link" title="werkzeug.security.gen_salt">gen​_salt</a></code></td>
    <td>Generate a random string of SALT_CHARS with specified <tt class="rst-docutils literal">length</tt>.</td>
  </tr><tr class="function">
    
    <td>Function</td>
    <td><code><a href="#generate_password_hash" class="internal-link" title="werkzeug.security.generate_password_hash">generate​_password​_hash</a></code></td>
    <td>Hash a password with the given method and salt with a string of the given length. The format of the string returned includes the method that was used so that <code><a href="#check_password_hash" class="internal-link" title="werkzeug.security.check_password_hash">check_password_hash</a></code> can check the hash.</td>
  </tr><tr class="function">
    
    <td>Function</td>
    <td><code><a href="#pbkdf2_bin" class="internal-link" title="werkzeug.security.pbkdf2_bin">pbkdf2​_bin</a></code></td>
    <td><span class="undocumented">No summary</span></td>
  </tr><tr class="function">
    
    <td>Function</td>
    <td><code><a href="#pbkdf2_hex" class="internal-link" title="werkzeug.security.pbkdf2_hex">pbkdf2​_hex</a></code></td>
    <td>Like <code><a href="#pbkdf2_bin" class="internal-link" title="werkzeug.security.pbkdf2_bin">pbkdf2_bin</a></code>, but returns a hex-encoded string.</td>
  </tr><tr class="function">
    
    <td>Function</td>
    <td><code><a href="#safe_join" class="internal-link" title="werkzeug.security.safe_join">safe​_join</a></code></td>
    <td>Safely join zero or more untrusted path components to a base directory to avoid escaping the base directory.</td>
  </tr><tr class="function">
    
    <td>Function</td>
    <td><code><a href="#safe_str_cmp" class="internal-link" title="werkzeug.security.safe_str_cmp">safe​_str​_cmp</a></code></td>
    <td>This function compares strings in somewhat constant time.  This requires that the length of at least one string is known in advance.</td>
  </tr><tr class="constant">
    
    <td>Constant</td>
    <td><code><a href="#DEFAULT_PBKDF2_ITERATIONS" class="internal-link" title="werkzeug.security.DEFAULT_PBKDF2_ITERATIONS">DEFAULT​_PBKDF2​_ITERATIONS</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="constant">
    
    <td>Constant</td>
    <td><code><a href="#SALT_CHARS" class="internal-link" title="werkzeug.security.SALT_CHARS">SALT​_CHARS</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="function private">
    
    <td>Function</td>
    <td><code><a href="#_hash_internal" class="internal-link" title="werkzeug.security._hash_internal">​_hash​_internal</a></code></td>
    <td>Internal password hash helper.  Supports plaintext without salt, unsalted and salted passwords.  In case salted passwords are used hmac is used.</td>
  </tr><tr class="variable private">
    
    <td>Variable</td>
    <td><code><a href="#_os_alt_seps" class="internal-link" title="werkzeug.security._os_alt_seps">​_os​_alt​_seps</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr>
</table>
        

          
      </div>

      <div id="childList">

        <div class="basefunction">
  
  
  <a name="werkzeug.security.check_password_hash">
    
  </a>
  <a name="check_password_hash">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">check_password_hash</span>(pwhash, password):
    
  </div>
  <div class="docstring functionBody">
    
    
    <div><p>Check a password against a given salted and hashed password value.
In order to support unsalted legacy passwords this method supports
plain text passwords, md5 and sha1 hashes (both salted and unsalted).</p>
<p>Returns <code>True</code> if the password matched, <code>False</code> otherwise.</p>
<table class="fieldTable"><tr class="fieldStart"><td class="fieldName" colspan="2">Parameters</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">pwhash:</span><code>str</code></td><td class="fieldArgDesc">a hashed string like returned by
<code><a href="#generate_password_hash" class="internal-link" title="werkzeug.security.generate_password_hash">generate_password_hash</a></code>.</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">password:</span><code>str</code></td><td class="fieldArgDesc">the plaintext password to compare against the hash.</td></tr><tr class="fieldStart"><td class="fieldName" colspan="2">Returns</td></tr><tr><td class="fieldArgContainer"><code>bool</code></td><td class="fieldArgDesc"><span class="undocumented">Undocumented</span></td></tr></table></div>
  </div>
</div><div class="basefunction">
  
  
  <a name="werkzeug.security.gen_salt">
    
  </a>
  <a name="gen_salt">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">gen_salt</span>(length):
    
  </div>
  <div class="docstring functionBody">
    
    
    <div>Generate a random string of SALT_CHARS with specified <tt class="rst-docutils literal">length</tt>.<table class="fieldTable"><tr class="fieldStart"><td class="fieldName" colspan="2">Parameters</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">length:</span><code>int</code></td><td class="fieldArgDesc"><span class="undocumented">Undocumented</span></td></tr><tr class="fieldStart"><td class="fieldName" colspan="2">Returns</td></tr><tr><td class="fieldArgContainer"><code>str</code></td><td class="fieldArgDesc"><span class="undocumented">Undocumented</span></td></tr></table></div>
  </div>
</div><div class="basefunction">
  
  
  <a name="werkzeug.security.generate_password_hash">
    
  </a>
  <a name="generate_password_hash">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">generate_password_hash</span>(password, method=<span class="rst-variable-quote">'</span><span class="rst-variable-string">pbkdf2:sha256</span><span class="rst-variable-quote">'</span>, salt_length=16):
    
  </div>
  <div class="docstring functionBody">
    
    
    <div><p>Hash a password with the given method and salt with a string of
the given length. The format of the string returned includes the method
that was used so that <code><a href="#check_password_hash" class="internal-link" title="werkzeug.security.check_password_hash">check_password_hash</a></code> can check the hash.</p>
<p>The format for the hashed string looks like this:</p>
<pre class="rst-literal-block">
method$salt$hash
</pre>
<p>This method can <strong>not</strong> generate unsalted passwords but it is possible
to set param method='plain' in order to enforce plaintext passwords.
If a salt is used, hmac is used internally to salt the password.</p>
<p>If PBKDF2 is wanted it can be enabled by setting the method to
<tt class="rst-docutils literal">pbkdf2:method:iterations</tt> where iterations is optional:</p>
<pre class="rst-literal-block">
pbkdf2:sha256:80000$salt$hash
pbkdf2:sha256$salt$hash
</pre>
<table class="fieldTable"><tr class="fieldStart"><td class="fieldName" colspan="2">Parameters</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">password:</span><code>str</code></td><td class="fieldArgDesc">the password to hash.</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">method:</span><code>str</code></td><td class="fieldArgDesc">the hash method to use (one that hashlib supports). Can
optionally be in the format <tt class="rst-docutils literal">pbkdf2:method:iterations</tt>
to enable PBKDF2.</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">salt​_length:</span><code>int</code></td><td class="fieldArgDesc">the length of the salt in letters.</td></tr><tr class="fieldStart"><td class="fieldName" colspan="2">Returns</td></tr><tr><td class="fieldArgContainer"><code>str</code></td><td class="fieldArgDesc"><span class="undocumented">Undocumented</span></td></tr></table></div>
  </div>
</div><div class="basefunction">
  
  
  <a name="werkzeug.security.pbkdf2_bin">
    
  </a>
  <a name="pbkdf2_bin">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">pbkdf2_bin</span>(data, salt, iterations=<a href="#DEFAULT_PBKDF2_ITERATIONS" class="internal-link" title="werkzeug.security.DEFAULT_PBKDF2_ITERATIONS">DEFAULT_PBKDF2_ITERATIONS</a>, keylen=None, hashfunc=None):
    
  </div>
  <div class="docstring functionBody">
    
    
    <div><p>Returns a binary digest for the PBKDF2 hash algorithm of <code>data</code>
with the given <code>salt</code>. It iterates <code>iterations</code> times and produces a
key of <code>keylen</code> bytes. By default, SHA-256 is used as hash function;
a different hashlib <code>hashfunc</code> can be provided.</p>
<div class="rst-deprecated">
<span class="rst-versionmodified rst-deprecated">Deprecated since version 2.0: </span><span>Will be removed in Werkzeug 2.1. Use <code>hashlib.pbkdf2_hmac</code>
instead.</span></div>
<div class="rst-versionadded">
<span class="rst-versionmodified rst-added">New in version 0.9.</span></div>
<table class="fieldTable"><tr class="fieldStart"><td class="fieldName" colspan="2">Parameters</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">data:</span><code>t.Union[<wbr></wbr>str, <wbr></wbr>bytes]</code></td><td class="fieldArgDesc">the data to derive.</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">salt:</span><code>t.Union[<wbr></wbr>str, <wbr></wbr>bytes]</code></td><td class="fieldArgDesc">the salt for the derivation.</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">iterations:</span><code>int</code></td><td class="fieldArgDesc">the number of iterations.</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">keylen:</span><code>t.Optional[<wbr></wbr>int]</code></td><td class="fieldArgDesc">the length of the resulting key.  If not provided
the digest size will be used.</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">hashfunc:</span><code>t.Optional[<wbr></wbr>t.Union[<wbr></wbr>str, <wbr></wbr>t.Callable]]</code></td><td class="fieldArgDesc">the hash function to use.  This can either be the
string name of a known hash function or a function
from the hashlib module.  Defaults to sha256.</td></tr><tr class="fieldStart"><td class="fieldName" colspan="2">Returns</td></tr><tr><td class="fieldArgContainer"><code>bytes</code></td><td class="fieldArgDesc"><span class="undocumented">Undocumented</span></td></tr></table></div>
  </div>
</div><div class="basefunction">
  
  
  <a name="werkzeug.security.pbkdf2_hex">
    
  </a>
  <a name="pbkdf2_hex">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">pbkdf2_hex</span>(data, salt, iterations=<a href="#DEFAULT_PBKDF2_ITERATIONS" class="internal-link" title="werkzeug.security.DEFAULT_PBKDF2_ITERATIONS">DEFAULT_PBKDF2_ITERATIONS</a>, keylen=None, hashfunc=None):
    
  </div>
  <div class="docstring functionBody">
    
    
    <div><p>Like <code><a href="#pbkdf2_bin" class="internal-link" title="werkzeug.security.pbkdf2_bin">pbkdf2_bin</a></code>, but returns a hex-encoded string.</p>
<div class="rst-deprecated">
<span class="rst-versionmodified rst-deprecated">Deprecated since version 2.0: </span><span>Will be removed in Werkzeug 2.1. Use <code>hashlib.pbkdf2_hmac</code>
instead.</span></div>
<div class="rst-versionadded">
<span class="rst-versionmodified rst-added">New in version 0.9.</span></div>
<table class="fieldTable"><tr class="fieldStart"><td class="fieldName" colspan="2">Parameters</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">data:</span><code>t.Union[<wbr></wbr>str, <wbr></wbr>bytes]</code></td><td class="fieldArgDesc">the data to derive.</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">salt:</span><code>t.Union[<wbr></wbr>str, <wbr></wbr>bytes]</code></td><td class="fieldArgDesc">the salt for the derivation.</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">iterations:</span><code>int</code></td><td class="fieldArgDesc">the number of iterations.</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">keylen:</span><code>t.Optional[<wbr></wbr>int]</code></td><td class="fieldArgDesc">the length of the resulting key.  If not provided,
the digest size will be used.</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">hashfunc:</span><code>t.Optional[<wbr></wbr>t.Union[<wbr></wbr>str, <wbr></wbr>t.Callable]]</code></td><td class="fieldArgDesc">the hash function to use.  This can either be the
string name of a known hash function, or a function
from the hashlib module.  Defaults to sha256.</td></tr><tr class="fieldStart"><td class="fieldName" colspan="2">Returns</td></tr><tr><td class="fieldArgContainer"><code>str</code></td><td class="fieldArgDesc"><span class="undocumented">Undocumented</span></td></tr></table></div>
  </div>
</div><div class="basefunction">
  
  
  <a name="werkzeug.security.safe_join">
    
  </a>
  <a name="safe_join">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">safe_join</span>(directory, *pathnames):
    
  </div>
  <div class="docstring functionBody">
    
    
    <div>Safely join zero or more untrusted path components to a base
directory to avoid escaping the base directory.<table class="fieldTable"><tr class="fieldStart"><td class="fieldName" colspan="2">Parameters</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">directory:</span><code>str</code></td><td class="fieldArgDesc">The trusted base directory.</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">*pathnames:</span><code>str</code></td><td class="fieldArgDesc">The untrusted path components relative to the
base directory.</td></tr><tr class="fieldStart"><td class="fieldName" colspan="2">Returns</td></tr><tr><td class="fieldArgContainer"><code>t.Optional[<wbr></wbr>str]</code></td><td class="fieldArgDesc">A safe path, otherwise <tt class="rst-docutils literal">None</tt>.</td></tr></table></div>
  </div>
</div><div class="basefunction">
  
  
  <a name="werkzeug.security.safe_str_cmp">
    
  </a>
  <a name="safe_str_cmp">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">safe_str_cmp</span>(a, b):
    
  </div>
  <div class="docstring functionBody">
    
    
    <div><p>This function compares strings in somewhat constant time.  This
requires that the length of at least one string is known in advance.</p>
<p>Returns <code>True</code> if the two strings are equal, or <code>False</code> if they are not.</p>
<div class="rst-deprecated">
<span class="rst-versionmodified rst-deprecated">Deprecated since version 2.0: </span><span>Will be removed in Werkzeug 2.1. Use
<code>hmac.compare_digest</code> instead.</span></div>
<div class="rst-versionadded">
<span class="rst-versionmodified rst-added">New in version 0.7.</span></div>
<table class="fieldTable"><tr class="fieldStart"><td class="fieldName" colspan="2">Parameters</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">a:</span><code>str</code></td><td class="fieldArgDesc"><span class="undocumented">Undocumented</span></td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">b:</span><code>str</code></td><td class="fieldArgDesc"><span class="undocumented">Undocumented</span></td></tr><tr class="fieldStart"><td class="fieldName" colspan="2">Returns</td></tr><tr><td class="fieldArgContainer"><code>bool</code></td><td class="fieldArgDesc"><span class="undocumented">Undocumented</span></td></tr></table></div>
  </div>
</div><div class="baseconstant">
  
  
  <a name="werkzeug.security.DEFAULT_PBKDF2_ITERATIONS">
    
  </a>
  <a name="DEFAULT_PBKDF2_ITERATIONS">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">DEFAULT_PBKDF2_ITERATIONS</span>: <code>int</code> =
    
  </div>
  <div class="functionBody">
    
    
    <div><p class="undocumented">Undocumented</p></div>
    <table class="valueTable"><tr class="fieldStart"><td class="fieldName">Value</td></tr><tr><td><pre class="constant-value"><code>260000</code></pre></td></tr></table>
  </div>
</div><div class="baseconstant">
  
  
  <a name="werkzeug.security.SALT_CHARS">
    
  </a>
  <a name="SALT_CHARS">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">SALT_CHARS</span>: <code>str</code> =
    
  </div>
  <div class="functionBody">
    
    
    <div><p class="undocumented">Undocumented</p></div>
    <table class="valueTable"><tr class="fieldStart"><td class="fieldName">Value</td></tr><tr><td><pre class="constant-value"><code><span class="rst-variable-quote">'</span><span class="rst-variable-string">abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789</span><span class="rst-variable-quote">'</span></code></pre></td></tr></table>
  </div>
</div><div class="basefunction private">
  
  
  <a name="werkzeug.security._hash_internal">
    
  </a>
  <a name="_hash_internal">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">_hash_internal</span>(method, salt, password):
    
  </div>
  <div class="docstring functionBody">
    
    
    <div>Internal password hash helper.  Supports plaintext without salt,
unsalted and salted passwords.  In case salted passwords are used
hmac is used.<table class="fieldTable"><tr class="fieldStart"><td class="fieldName" colspan="2">Parameters</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">method:</span><code>str</code></td><td class="fieldArgDesc"><span class="undocumented">Undocumented</span></td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">salt:</span><code>str</code></td><td class="fieldArgDesc"><span class="undocumented">Undocumented</span></td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">password:</span><code>str</code></td><td class="fieldArgDesc"><span class="undocumented">Undocumented</span></td></tr><tr class="fieldStart"><td class="fieldName" colspan="2">Returns</td></tr><tr><td class="fieldArgContainer"><code>t.Tuple[<wbr></wbr>str, <wbr></wbr>str]</code></td><td class="fieldArgDesc"><span class="undocumented">Undocumented</span></td></tr></table></div>
  </div>
</div><div class="basevariable private">
  
  
  <a name="werkzeug.security._os_alt_seps">
    
  </a>
  <a name="_os_alt_seps">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">_os_alt_seps</span>: <code>t.List[<wbr></wbr>str]</code> =
    
  </div>
  <div class="functionBody">
    
    
    <div><p class="undocumented">Undocumented</p></div>
    
  </div>
</div>

      </div>
    </div>

    <footer class="navbar navbar-default">
  
  <div class="container">
    <a href="index.html">API Documentation</a> for werkzeug,
  generated by <a href="https://github.com/twisted/pydoctor/">pydoctor</a>
    22.2.0 at 2022-02-23 04:47:03.
  </div>
</footer>

    <script src="pydoctor.js" type="text/javascript"></script>

  </body>
</html>