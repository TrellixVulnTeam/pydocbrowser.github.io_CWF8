<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
          "DTD/xhtml1-strict.dtd">
<html>
  

  <head>
    
    <title>twisted.internet.ssl</title>
    <meta name="generator" content="pydoctor 22.2.0"> 
        
    </meta>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=0.75" />
    <link rel="stylesheet" type="text/css" href="bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="apidocs.css" />
    <link rel="stylesheet" type="text/css" href="extra.css" />
</head>

  <body>

    <div id="banner">    
    <div>
        <a href="/">Home</a>
        &gt; twisted-22.1.0 <!-- This is a placeholder -->
        
        <!-- (<a href=""&gt;show all versions</a&gt;) -->
    </div>
</div>

    <nav class="navbar navbar-default">
  
  <div class="container">

    <div class="navbar-header">
      
      <div class="navlinks">
          <span class="navbar-brand">
            twisted <a href="index.html">API Documentation</a>
          </span>

          <a href="moduleIndex.html">
            Modules
          </a>

          <a href="classIndex.html">
            Classes
          </a>

          <a href="nameIndex.html">
            Names
          </a>
      </div>

    </div>
  </div>
</nav>

    

    <div class="container">

      <div class="page-header">
        <h1 class="module"><code><code><a href="index.html" class="internal-link">twisted</a></code><wbr></wbr>.<code><a href="twisted.internet.html" class="internal-link" title="twisted.internet">internet</a></code><wbr></wbr>.<code><a href="twisted.internet.ssl.html" class="internal-link" title="twisted.internet.ssl">ssl</a></code></code></h1>
        <div id="showPrivate">
          <button class="btn btn-link" onclick="togglePrivate()">Toggle Private API</button>
        </div>
      </div>

      <div class="categoryHeader">
        module documentation
      </div>

      <div class="extrasDocstring">
        <a href="https://github.com/pydocbrowser/pydocbrowser.github.io/tree/main/build/sources/twisted-22.1.0//src/twisted/internet/ssl.py" class="sourceLink">(source)</a>
        <p></p>
      </div>

      <div class="moduleDocstring">
        <div><p>This module implements Transport Layer Security (TLS) support for Twisted.  It
requires U{PyOpenSSL &lt;<a class="rst-reference external" href="https://pypi.python.org/pypi/pyOpenSSL" target="_top">https://pypi.python.org/pypi/pyOpenSSL</a>&gt;}.</p>
<p>If you wish to establish a TLS connection, please use one of the following
APIs:</p>
<blockquote>
<ul class="rst-simple">
<li>SSL endpoints for L{servers
&lt;twisted.internet.endpoints.SSL4ServerEndpoint&gt;} and L{clients
&lt;twisted.internet.endpoints.SSL4ClientEndpoint&gt;}</li>
<li>L{startTLS &lt;twisted.internet.interfaces.ITLSTransport.startTLS&gt;}</li>
<li>L{connectSSL &lt;twisted.internet.interfaces.IReactorSSL.connectSSL&gt;}</li>
<li>L{listenSSL &lt;twisted.internet.interfaces.IReactorSSL.listenSSL&gt;}</li>
</ul>
</blockquote>
<p>These APIs all require a C{contextFactory} argument that specifies their
security properties, such as certificate, private key, certificate authorities
to verify the peer, allowed TLS protocol versions, cipher suites, and so on.
The recommended value for this argument is a L{CertificateOptions} instance;
see its documentation for an explanation of the available options.</p>
<p>The C{contextFactory} name is a bit of an anachronism now, as context factories
have been replaced with "connection creators", but these objects serve the same
role.</p>
<p>Be warned that implementing your own connection creator (i.e.: value for the
C{contextFactory}) is both difficult and dangerous; the Twisted team has worked
hard to make L{CertificateOptions}' API comprehensible and unsurprising, and
the Twisted team is actively maintaining it to ensure that it becomes more
secure over time.</p>
<p>If you are really absolutely sure that you want to take on the risk of
implementing your own connection creator based on the pyOpenSSL API, see the
L{server connection creator
&lt;twisted.internet.interfaces.IOpenSSLServerConnectionCreator&gt;} and L{client
connection creator
&lt;twisted.internet.interfaces.IOpenSSLServerConnectionCreator&gt;} interfaces.</p>
<p>Developers using Twisted, please ignore the L{Port}, L{Connector}, and
L{Client} classes defined here, as these are details of certain reactors' TLS
implementations, exposed by accident (and remaining here only for compatibility
reasons).  If you wish to establish a TLS connection, please use one of the
APIs listed above.</p>
<dl class="rst-docutils">
<dt>@note: "SSL" (Secure Sockets Layer) is an antiquated synonym for "TLS"</dt>
<dd>(Transport Layer Security).  You may see these terms used interchangeably
throughout the documentation.</dd>
</dl>
</div>
      </div>

      <div id="splitTables">
        <table class="children sortable" id="id3491">
  
  
  <tr class="class">
    
    <td>Class</td>
    <td><code><a href="twisted.internet.ssl.AcceptableCiphers.html" class="internal-link" title="twisted.internet.ssl.AcceptableCiphers">​Acceptable​Ciphers</a></code></td>
    <td>A representation of ciphers that are acceptable for TLS connections.</td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><code><a href="twisted.internet.ssl.Certificate.html" class="internal-link" title="twisted.internet.ssl.Certificate">​Certificate</a></code></td>
    <td>An x509 certificate.</td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><code><a href="twisted.internet.ssl.CertificateOptions.html" class="internal-link" title="twisted.internet.ssl.CertificateOptions">​Certificate​Options</a></code></td>
    <td>A L{CertificateOptions &lt;twisted.internet.ssl.CertificateOptions&gt;} specifies the security properties for a client or server TLS connection used with OpenSSL.</td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><code><a href="twisted.internet.ssl.CertificateRequest.html" class="internal-link" title="twisted.internet.ssl.CertificateRequest">​Certificate​Request</a></code></td>
    <td>An x509 certificate request.</td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><code><a href="twisted.internet.ssl.Client.html" class="internal-link" title="twisted.internet.ssl.Client">​Client</a></code></td>
    <td>I am an SSL client.</td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><code><a href="twisted.internet.ssl.ClientContextFactory.html" class="internal-link" title="twisted.internet.ssl.ClientContextFactory">​Client​Context​Factory</a></code></td>
    <td>A context factory for SSL clients.</td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><code><a href="twisted.internet.ssl.Connector.html" class="internal-link" title="twisted.internet.ssl.Connector">​Connector</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><code><a href="twisted.internet.ssl.ContextFactory.html" class="internal-link" title="twisted.internet.ssl.ContextFactory">​Context​Factory</a></code></td>
    <td>A factory for SSL context objects, for server SSL connections.</td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><code><a href="twisted.internet.ssl.DefaultOpenSSLContextFactory.html" class="internal-link" title="twisted.internet.ssl.DefaultOpenSSLContextFactory">​Default​Open​SSLContext​Factory</a></code></td>
    <td>L{DefaultOpenSSLContextFactory} is a factory for server-side SSL context objects.  These objects define certain parameters related to SSL handshakes and the subsequent connection.</td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><code><a href="twisted.internet.ssl.DiffieHellmanParameters.html" class="internal-link" title="twisted.internet.ssl.DiffieHellmanParameters">​Diffie​Hellman​Parameters</a></code></td>
    <td>A representation of key generation parameters that are required for Diffie-Hellman key exchange.</td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><code><a href="twisted.internet.ssl.DistinguishedName.html" class="internal-link" title="twisted.internet.ssl.DistinguishedName">​Distinguished​Name</a></code></td>
    <td>Identify and describe an entity.</td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><code><a href="twisted.internet.ssl.KeyPair.html" class="internal-link" title="twisted.internet.ssl.KeyPair">​Key​Pair</a></code></td>
    <td><span class="undocumented">No class docstring; 3/10 methods, 0/2 class method documented</span></td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><code><a href="twisted.internet.ssl.OpenSSLDefaultPaths.html" class="internal-link" title="twisted.internet.ssl.OpenSSLDefaultPaths">​Open​SSLDefault​Paths</a></code></td>
    <td>Trust the set of default verify paths that OpenSSL was built with, as specified by U{SSL_CTX_set_default_verify_paths &lt;<a class="rst-reference external" href="https://www.openssl.org/docs/man1.1.1/man3/SSL_CTX_load_verify_locations.html" target="_top">https://www.openssl.org/docs/man1.1.1/man3/SSL_CTX_load_verify_locations.html</a>&gt;}.</td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><code><a href="twisted.internet.ssl.Port.html" class="internal-link" title="twisted.internet.ssl.Port">​Port</a></code></td>
    <td>I am an SSL port.</td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><code><a href="twisted.internet.ssl.PrivateCertificate.html" class="internal-link" title="twisted.internet.ssl.PrivateCertificate">​Private​Certificate</a></code></td>
    <td>An x509 certificate and private key.</td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><code><a href="twisted.internet.ssl.ProtocolNegotiationSupport.html" class="internal-link" title="twisted.internet.ssl.ProtocolNegotiationSupport">​Protocol​Negotiation​Support</a></code></td>
    <td>L{ProtocolNegotiationSupport} defines flags which are used to indicate the level of NPN/ALPN support provided by the TLS backend.</td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><code><a href="twisted.internet.ssl.Server.html" class="internal-link" title="twisted.internet.ssl.Server">​Server</a></code></td>
    <td>I am an SSL server.</td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><code><a href="twisted.internet.ssl.TLSVersion.html" class="internal-link" title="twisted.internet.ssl.TLSVersion">​TLSVersion</a></code></td>
    <td>TLS versions that we can negotiate with the client/server.</td>
  </tr><tr class="function">
    
    <td>Function</td>
    <td><code><a href="#optionsForClientTLS" class="internal-link" title="twisted.internet.ssl.optionsForClientTLS">options​For​Client​TLS</a></code></td>
    <td><span class="undocumented">No summary</span></td>
  </tr><tr class="function">
    
    <td>Function</td>
    <td><code><a href="#platformTrust" class="internal-link" title="twisted.internet.ssl.platformTrust">platform​Trust</a></code></td>
    <td>Attempt to discover a set of trusted certificate authority certificates (or, in other words: trust roots, or root certificates) whose trust is managed and updated by tools outside of Twisted.</td>
  </tr><tr class="function">
    
    <td>Function</td>
    <td><code><a href="#protocolNegotiationMechanisms" class="internal-link" title="twisted.internet.ssl.protocolNegotiationMechanisms">protocol​Negotiation​Mechanisms</a></code></td>
    <td>Checks whether your versions of PyOpenSSL and OpenSSL are recent enough to support protocol negotiation, and if they are, what kind of protocol negotiation is supported.</td>
  </tr><tr class="function">
    
    <td>Function</td>
    <td><code><a href="#trustRootFromCertificates" class="internal-link" title="twisted.internet.ssl.trustRootFromCertificates">trust​Root​From​Certificates</a></code></td>
    <td>Builds an object that trusts multiple root L{Certificate}s.</td>
  </tr><tr class="variable">
    
    <td>Variable</td>
    <td><code><a href="#supported" class="internal-link" title="twisted.internet.ssl.supported">supported</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="variable">
    
    <td>Variable</td>
    <td><code><a href="#VerificationError" class="internal-link" title="twisted.internet.ssl.VerificationError">​Verification​Error</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr>
</table>
        

          
      </div>

      <div id="childList">

        <div class="basefunction">
  
  
  <a name="twisted.internet.ssl.optionsForClientTLS">
    
  </a>
  <a name="optionsForClientTLS">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">optionsForClientTLS</span>(hostname, trustRoot=<a href="https://docs.python.org/3/library/constants.html#None" class="intersphinx-link">None</a>, clientCertificate=<a href="https://docs.python.org/3/library/constants.html#None" class="intersphinx-link">None</a>, acceptableProtocols=<a href="https://docs.python.org/3/library/constants.html#None" class="intersphinx-link">None</a>, *, extraCertificateOptions=<a href="https://docs.python.org/3/library/constants.html#None" class="intersphinx-link">None</a>):
    <a class="sourceLink" href="https://github.com/pydocbrowser/pydocbrowser.github.io/tree/main/build/sources/twisted-22.1.0//src/twisted/internet/_sslverify.py#L1183">
      
      (source)
    </a>
  </div>
  <div class="docstring functionBody">
    
    
    <div><p>Create a L{client connection creator &lt;IOpenSSLClientConnectionCreator&gt;} for
use with APIs such as L{SSL4ClientEndpoint
&lt;twisted.internet.endpoints.SSL4ClientEndpoint&gt;}, L{connectSSL
&lt;twisted.internet.interfaces.IReactorSSL.connectSSL&gt;}, and L{startTLS
&lt;twisted.internet.interfaces.ITLSTransport.startTLS&gt;}.</p>
<p>@since: 14.0</p>
<dl class="rst-docutils">
<dt>@param hostname: The expected name of the remote host. This serves two</dt>
<dd>purposes: first, and most importantly, it verifies that the certificate
received from the server correctly identifies the specified hostname.
The second purpose is to use the U{Server Name Indication extension
&lt;<a class="rst-reference external" href="https://en.wikipedia.org/wiki/Server_Name_Indication" target="_top">https://en.wikipedia.org/wiki/Server_Name_Indication</a>&gt;} to indicate to
the server which certificate should be used.</dd>
</dl>
<p>@type hostname: L{unicode}</p>
<dl class="rst-docutils">
<dt>@param trustRoot: Specification of trust requirements of peers. This may be</dt>
<dd>a L{Certificate} or the result of L{platformTrust}. By default it is
L{platformTrust} and you probably shouldn't adjust it unless you really
know what you're doing. Be aware that clients using this interface
I{must} verify the server; you cannot explicitly pass L{None} since
that just means to use L{platformTrust}.</dd>
</dl>
<p>@type trustRoot: L{IOpenSSLTrustRoot}</p>
<dl class="rst-docutils">
<dt>@param clientCertificate: The certificate and private key that the client</dt>
<dd>will use to authenticate to the server. If unspecified, the client will
not authenticate.</dd>
</dl>
<p>@type clientCertificate: L{PrivateCertificate}</p>
<dl class="rst-docutils">
<dt>@param acceptableProtocols: The protocols this peer is willing to speak</dt>
<dd>after the TLS negotiation has completed, advertised over both ALPN and
NPN. If this argument is specified, and no overlap can be found with
the other peer, the connection will fail to be established. If the
remote peer does not offer NPN or ALPN, the connection will be
established, but no protocol wil be negotiated. Protocols earlier in
the list are preferred over those later in the list.</dd>
</dl>
<p>@type acceptableProtocols: L{list} of L{bytes}</p>
<dl class="rst-docutils">
<dt>@param extraCertificateOptions: A dictionary of additional keyword arguments</dt>
<dd>to be presented to L{CertificateOptions}. Please avoid using this unless
you absolutely need to; any time you need to pass an option here that is
a bug in this interface.</dd>
</dl>
<p>@type extraCertificateOptions: L{dict}</p>
<p>@return: A client connection creator.
@rtype: L{IOpenSSLClientConnectionCreator}</p>
</div>
  </div>
</div><div class="basefunction">
  
  
  <a name="twisted.internet.ssl.platformTrust">
    
  </a>
  <a name="platformTrust">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">platformTrust</span>():
    <a class="sourceLink" href="https://github.com/pydocbrowser/pydocbrowser.github.io/tree/main/build/sources/twisted-22.1.0//src/twisted/internet/_sslverify.py#L971">
      
      (source)
    </a>
  </div>
  <div class="docstring functionBody">
    
    
    <div><p>Attempt to discover a set of trusted certificate authority certificates
(or, in other words: trust roots, or root certificates) whose trust is
managed and updated by tools outside of Twisted.</p>
<p>If you are writing any client-side TLS code with Twisted, you should use
this as the C{trustRoot} argument to L{CertificateOptions
&lt;twisted.internet.ssl.CertificateOptions&gt;}.</p>
<p>The result of this function should be like the up-to-date list of
certificates in a web browser.  When developing code that uses
C{platformTrust}, you can think of it that way.  However, the choice of
which certificate authorities to trust is never Twisted's responsibility.
Unless you're writing a very unusual application or library, it's not your
code's responsibility either.  The user may use platform-specific tools for
defining which server certificates should be trusted by programs using TLS.
The purpose of using this API is to respect that decision as much as
possible.</p>
<p>This should be a set of trust settings most appropriate for I{client} TLS
connections; i.e. those which need to verify a server's authenticity.  You
should probably use this by default for any client TLS connection that you
create.  For servers, however, client certificates are typically not
verified; or, if they are, their verification will depend on a custom,
application-specific certificate authority.</p>
<p>@since: 14.0</p>
<dl class="rst-docutils">
<dt>@note: Currently, L{platformTrust} depends entirely upon your OpenSSL build</dt>
<dd><p class="rst-first">supporting a set of "L{default verify paths &lt;OpenSSLDefaultPaths&gt;}"
which correspond to certificate authority trust roots.  Unfortunately,
whether this is true of your system is both outside of Twisted's
control and difficult (if not impossible) for Twisted to detect
automatically.</p>
<p>Nevertheless, this ought to work as desired by default on:</p>
<blockquote>
<ul class="rst-simple">
<li>Ubuntu Linux machines with the U{ca-certificates
&lt;<a class="rst-reference external" href="https://launchpad.net/ubuntu/+source/ca-certificates" target="_top">https://launchpad.net/ubuntu/+source/ca-certificates</a>&gt;} package
installed,</li>
<li>macOS when using the system-installed version of OpenSSL (i.e.
I{not} one installed via MacPorts or Homebrew),</li>
<li>any build of OpenSSL which has had certificate authority
certificates installed into its default verify paths (by default,
C{/usr/local/ssl/certs} if you've built your own OpenSSL), or</li>
<li>any process where the C{SSL_CERT_FILE} environment variable is
set to the path of a file containing your desired CA certificates
bundle.</li>
</ul>
</blockquote>
<p class="rst-last">Hopefully soon, this API will be updated to use more sophisticated
trust-root discovery mechanisms.  Until then, you can follow tickets in
the Twisted tracker for progress on this implementation on U{Microsoft
Windows &lt;<a class="rst-reference external" href="https://twistedmatrix.com/trac/ticket/6371" target="_top">https://twistedmatrix.com/trac/ticket/6371</a>&gt;}, U{macOS
&lt;<a class="rst-reference external" href="https://twistedmatrix.com/trac/ticket/6372" target="_top">https://twistedmatrix.com/trac/ticket/6372</a>&gt;}, and U{a fallback for
other platforms which do not have native trust management tools
&lt;<a class="rst-reference external" href="https://twistedmatrix.com/trac/ticket/6934" target="_top">https://twistedmatrix.com/trac/ticket/6934</a>&gt;}.</p>
</dd>
</dl>
<p>@return: an appropriate trust settings object for your platform.
@rtype: L{IOpenSSLTrustRoot}</p>
<dl class="rst-docutils">
<dt>@raise NotImplementedError: if this platform is not yet supported by</dt>
<dd>Twisted.  At present, only OpenSSL is supported.</dd>
</dl>
</div>
  </div>
</div><div class="basefunction">
  
  
  <a name="twisted.internet.ssl.protocolNegotiationMechanisms">
    
  </a>
  <a name="protocolNegotiationMechanisms">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">protocolNegotiationMechanisms</span>():
    <a class="sourceLink" href="https://github.com/pydocbrowser/pydocbrowser.github.io/tree/main/build/sources/twisted-22.1.0//src/twisted/internet/_sslverify.py#L213">
      
      (source)
    </a>
  </div>
  <div class="docstring functionBody">
    
    
    <div><p>Checks whether your versions of PyOpenSSL and OpenSSL are recent enough to
support protocol negotiation, and if they are, what kind of protocol
negotiation is supported.</p>
<dl class="rst-docutils">
<dt>@return: A combination of flags from L{ProtocolNegotiationSupport} that</dt>
<dd>indicate which mechanisms for protocol negotiation are supported.</dd>
</dl>
<p>@rtype: L{constantly.FlagConstant}</p>
</div>
  </div>
</div><div class="basefunction">
  
  
  <a name="twisted.internet.ssl.trustRootFromCertificates">
    
  </a>
  <a name="trustRootFromCertificates">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">trustRootFromCertificates</span>(certificates):
    <a class="sourceLink" href="https://github.com/pydocbrowser/pydocbrowser.github.io/tree/main/build/sources/twisted-22.1.0//src/twisted/internet/_sslverify.py#L928">
      
      (source)
    </a>
  </div>
  <div class="docstring functionBody">
    
    
    <div><p>Builds an object that trusts multiple root L{Certificate}s.</p>
<p>When passed to L{optionsForClientTLS}, connections using those options will
reject any server certificate not signed by at least one of the
certificates in the <code>certificates</code> list.</p>
<p>@since: 16.0</p>
<p>@param certificates: All certificates which will be trusted.
@type certificates: C{iterable} of L{CertBase}</p>
<p>@rtype: L{IOpenSSLTrustRoot}
@return: an object suitable for use as the trustRoot= keyword argument to</p>
<blockquote>
L{optionsForClientTLS}</blockquote>
</div>
  </div>
</div><div class="basevariable">
  
  
  <a name="twisted.internet.ssl.supported">
    
  </a>
  <a name="supported">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">supported</span>: <code><a href="https://docs.python.org/3/library/functions.html#bool" class="intersphinx-link">bool</a></code> =
    <a class="sourceLink" href="https://github.com/pydocbrowser/pydocbrowser.github.io/tree/main/build/sources/twisted-22.1.0//src/twisted/internet/ssl.py#L65">
      
      (source)
    </a>
  </div>
  <div class="functionBody">
    
    
    <div><p class="undocumented">Undocumented</p></div>
    
  </div>
</div><div class="basevariable">
  
  
  <a name="twisted.internet.ssl.VerificationError">
    
  </a>
  <a name="VerificationError">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">VerificationError</span> =
    <a class="sourceLink" href="https://github.com/pydocbrowser/pydocbrowser.github.io/tree/main/build/sources/twisted-22.1.0//src/twisted/internet/_sslverify.py#L185">
      
      (source)
    </a>
  </div>
  <div class="functionBody">
    
    
    <div><p class="undocumented">Undocumented</p></div>
    
  </div>
</div>

      </div>
    </div>

    <footer class="navbar navbar-default">
  
  <div class="container">
    <a href="index.html">API Documentation</a> for twisted,
  generated by <a href="https://github.com/twisted/pydoctor/">pydoctor</a>
    22.2.0 at 2022-02-23 16:05:07.
  </div>
</footer>

    <script src="pydoctor.js" type="text/javascript"></script>

  </body>
</html>