<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
          "DTD/xhtml1-strict.dtd">
<html>
  

  <head>
    
    <title>sqlalchemy.ext.orderinglist</title>
    <meta name="generator" content="pydoctor 22.2.0"> 
        
    </meta>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=0.75" />
    <link rel="stylesheet" type="text/css" href="bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="apidocs.css" />
    <link rel="stylesheet" type="text/css" href="extra.css" />
</head>

  <body>

    <div id="banner" class="container">    
    <div>
        <a href="https://pydocbrowser.github.io/">Home</a>
        &gt; sqlalchemy-1.4.31 
        <!-- This is an important placeholder and will be 
            replaced by project name and version on building docs -->
        
        <!-- (<a href=""&gt;show all versions</a&gt;) -->
    </div>
</div>

    <nav class="navbar navbar-default">
  
  <div class="container">

    <div class="navbar-header">
      
      <div class="navlinks">
          <span class="navbar-brand">
            sqlalchemy <a href="index.html">API Documentation</a>
          </span>

          <a href="moduleIndex.html">
            Modules
          </a>

          <a href="classIndex.html">
            Classes
          </a>

          <a href="nameIndex.html">
            Names
          </a>
      </div>

    </div>
  </div>
</nav>

    

    <div class="container">

      <div class="page-header">
        <h1 class="module"><code><code><a href="index.html" class="internal-link">sqlalchemy</a></code><wbr></wbr>.<code><a href="sqlalchemy.ext.html" class="internal-link" title="sqlalchemy.ext">ext</a></code><wbr></wbr>.<code><a href="sqlalchemy.ext.orderinglist.html" class="internal-link" title="sqlalchemy.ext.orderinglist">orderinglist</a></code></code></h1>
        <div id="showPrivate">
          <button class="btn btn-link" onclick="togglePrivate()">Toggle Private API</button>
        </div>
      </div>

      <div class="categoryHeader">
        module documentation
      </div>

      <div class="extrasDocstring">
        <a href="https://github.com/pydocbrowser/pydocbrowser.github.io/tree/main/build/sources/sqlalchemy-1.4.31//lib/sqlalchemy/ext/orderinglist.py" class="sourceLink">(source)</a>
        <p></p>
      </div>

      <div class="moduleDocstring">
        <div><p>A custom list that manages index/position information for contained
elements.</p>
<p><tt class="rst-docutils literal">orderinglist</tt> is a helper for mutable ordered relationships.  It will
intercept list operations performed on a <code>_orm.relationship</code>-managed
collection and
automatically synchronize changes in list position onto a target scalar
attribute.</p>
<p>Example: A <tt class="rst-docutils literal">slide</tt> table, where each row refers to zero or more entries
in a related <tt class="rst-docutils literal">bullet</tt> table.   The bullets within a slide are
displayed in order based on the value of the <tt class="rst-docutils literal">position</tt> column in the
<tt class="rst-docutils literal">bullet</tt> table.   As entries are reordered in memory, the value of the
<tt class="rst-docutils literal">position</tt> attribute should be updated to reflect the new sort order:</p>
<pre class="rst-literal-block">
Base = declarative_base()

class Slide(Base):
    __tablename__ = 'slide'

    id = Column(Integer, primary_key=True)
    name = Column(String)

    bullets = relationship("Bullet", order_by="Bullet.position")

class Bullet(Base):
    __tablename__ = 'bullet'
    id = Column(Integer, primary_key=True)
    slide_id = Column(Integer, ForeignKey('slide.id'))
    position = Column(Integer)
    text = Column(String)
</pre>
<p>The standard relationship mapping will produce a list-like attribute on each
<tt class="rst-docutils literal">Slide</tt> containing all related <tt class="rst-docutils literal">Bullet</tt> objects,
but coping with changes in ordering is not handled automatically.
When appending a <tt class="rst-docutils literal">Bullet</tt> into <tt class="rst-docutils literal">Slide.bullets</tt>, the <tt class="rst-docutils literal">Bullet.position</tt>
attribute will remain unset until manually assigned.   When the <tt class="rst-docutils literal">Bullet</tt>
is inserted into the middle of the list, the following <tt class="rst-docutils literal">Bullet</tt> objects
will also need to be renumbered.</p>
<p>The <code>.OrderingList</code> object automates this task, managing the
<tt class="rst-docutils literal">position</tt> attribute on all <tt class="rst-docutils literal">Bullet</tt> objects in the collection.  It is
constructed using the <code>.ordering_list</code> factory:</p>
<pre class="rst-literal-block">
from sqlalchemy.ext.orderinglist import ordering_list

Base = declarative_base()

class Slide(Base):
    __tablename__ = 'slide'

    id = Column(Integer, primary_key=True)
    name = Column(String)

    bullets = relationship("Bullet", order_by="Bullet.position",
                            collection_class=ordering_list('position'))

class Bullet(Base):
    __tablename__ = 'bullet'
    id = Column(Integer, primary_key=True)
    slide_id = Column(Integer, ForeignKey('slide.id'))
    position = Column(Integer)
    text = Column(String)
</pre>
<p>With the above mapping the <tt class="rst-docutils literal">Bullet.position</tt> attribute is managed:</p>
<pre class="rst-literal-block">
s = Slide()
s.bullets.append(Bullet())
s.bullets.append(Bullet())
s.bullets[1].position
&gt;&gt;&gt; 1
s.bullets.insert(1, Bullet())
s.bullets[2].position
&gt;&gt;&gt; 2
</pre>
<p>The <code>.OrderingList</code> construct only works with <strong>changes</strong> to a
collection, and not the initial load from the database, and requires that the
list be sorted when loaded.  Therefore, be sure to specify <tt class="rst-docutils literal">order_by</tt> on the
<code>_orm.relationship</code> against the target ordering attribute, so that the
ordering is correct when first loaded.</p>
<div class="rst-admonition warning">
<p class="rst-first rst-admonition-title">Warning</p>
<p><code>.OrderingList</code> only provides limited functionality when a primary
key column or unique column is the target of the sort.  Operations
that are unsupported or are problematic include:</p>
<blockquote class="rst-last">
<ul class="rst-simple">
<li>two entries must trade values.  This is not supported directly in the
case of a primary key or unique constraint because it means at least
one row would need to be temporarily removed first, or changed to
a third, neutral value while the switch occurs.</li>
<li>an entry must be deleted in order to make room for a new entry.
SQLAlchemy's unit of work performs all INSERTs before DELETEs within a
single flush.  In the case of a primary key, it will trade
an INSERT/DELETE of the same primary key for an UPDATE statement in order
to lessen the impact of this limitation, however this does not take place
for a UNIQUE column.
A future feature will allow the "DELETE before INSERT" behavior to be
possible, alleviating this limitation, though this feature will require
explicit configuration at the mapper level for sets of columns that
are to be handled in this way.</li>
</ul>
</blockquote>
</div>
<p><code>.ordering_list</code> takes the name of the related object's ordering
attribute as an argument.  By default, the zero-based integer index of the
object's position in the <code>.ordering_list</code> is synchronized with the
ordering attribute: index 0 will get position 0, index 1 position 1, etc.  To
start numbering at 1 or some other integer, provide <tt class="rst-docutils literal">count_from=1</tt>.</p>
<table class="fieldTable"><tr class="fieldStart"><td class="fieldName" colspan="2">Author</td></tr><tr><td colspan="2">Jason Kirtland</td></tr></table></div>
      </div>

      <div id="splitTables">
        <table class="children sortable" id="id20645">
  
  
  <tr class="class">
    
    <td>Class</td>
    <td><code><a href="sqlalchemy.ext.orderinglist.OrderingList.html" class="internal-link" title="sqlalchemy.ext.orderinglist.OrderingList">​Ordering​List</a></code></td>
    <td>A custom list that manages position information for its children.</td>
  </tr><tr class="function">
    
    <td>Function</td>
    <td><code><a href="#count_from_0" class="internal-link" title="sqlalchemy.ext.orderinglist.count_from_0">count​_from​_0</a></code></td>
    <td>Numbering function: consecutive integers starting at 0.</td>
  </tr><tr class="function">
    
    <td>Function</td>
    <td><code><a href="#count_from_1" class="internal-link" title="sqlalchemy.ext.orderinglist.count_from_1">count​_from​_1</a></code></td>
    <td>Numbering function: consecutive integers starting at 1.</td>
  </tr><tr class="function">
    
    <td>Function</td>
    <td><code><a href="#count_from_n_factory" class="internal-link" title="sqlalchemy.ext.orderinglist.count_from_n_factory">count​_from​_n​_factory</a></code></td>
    <td>Numbering function: consecutive integers starting at arbitrary start.</td>
  </tr><tr class="function">
    
    <td>Function</td>
    <td><code><a href="#ordering_list" class="internal-link" title="sqlalchemy.ext.orderinglist.ordering_list">ordering​_list</a></code></td>
    <td>Prepares an <code><a href="sqlalchemy.ext.orderinglist.OrderingList.html" class="internal-link" title="sqlalchemy.ext.orderinglist.OrderingList">OrderingList</a></code> factory for use in mapper definitions.</td>
  </tr><tr class="function private">
    
    <td>Function</td>
    <td><code><a href="#_reconstitute" class="internal-link" title="sqlalchemy.ext.orderinglist._reconstitute">​_reconstitute</a></code></td>
    <td>Reconstitute an <code>.OrderingList</code>.</td>
  </tr><tr class="function private">
    
    <td>Function</td>
    <td><code><a href="#_unsugar_count_from" class="internal-link" title="sqlalchemy.ext.orderinglist._unsugar_count_from">​_unsugar​_count​_from</a></code></td>
    <td>Builds counting functions from keyword arguments.</td>
  </tr>
</table>
        

          
      </div>

      <div id="childList">

        <div class="basefunction">
  
  
  <a name="sqlalchemy.ext.orderinglist.count_from_0">
    
  </a>
  <a name="count_from_0">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">count_from_0</span>(index, collection):
    <a class="sourceLink" href="https://github.com/pydocbrowser/pydocbrowser.github.io/tree/main/build/sources/sqlalchemy-1.4.31//lib/sqlalchemy/ext/orderinglist.py#L167">
      
      (source)
    </a>
  </div>
  <div class="docstring functionBody">
    
    
    <div>Numbering function: consecutive integers starting at 0.</div>
  </div>
</div><div class="basefunction">
  
  
  <a name="sqlalchemy.ext.orderinglist.count_from_1">
    
  </a>
  <a name="count_from_1">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">count_from_1</span>(index, collection):
    <a class="sourceLink" href="https://github.com/pydocbrowser/pydocbrowser.github.io/tree/main/build/sources/sqlalchemy-1.4.31//lib/sqlalchemy/ext/orderinglist.py#L173">
      
      (source)
    </a>
  </div>
  <div class="docstring functionBody">
    
    
    <div>Numbering function: consecutive integers starting at 1.</div>
  </div>
</div><div class="basefunction">
  
  
  <a name="sqlalchemy.ext.orderinglist.count_from_n_factory">
    
  </a>
  <a name="count_from_n_factory">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">count_from_n_factory</span>(start):
    <a class="sourceLink" href="https://github.com/pydocbrowser/pydocbrowser.github.io/tree/main/build/sources/sqlalchemy-1.4.31//lib/sqlalchemy/ext/orderinglist.py#L179">
      
      (source)
    </a>
  </div>
  <div class="docstring functionBody">
    
    
    <div>Numbering function: consecutive integers starting at arbitrary start.</div>
  </div>
</div><div class="basefunction">
  
  
  <a name="sqlalchemy.ext.orderinglist.ordering_list">
    
  </a>
  <a name="ordering_list">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">ordering_list</span>(attr, count_from=<a href="https://docs.python.org/3/library/constants.html#None" class="intersphinx-link">None</a>, **kw):
    <a class="sourceLink" href="https://github.com/pydocbrowser/pydocbrowser.github.io/tree/main/build/sources/sqlalchemy-1.4.31//lib/sqlalchemy/ext/orderinglist.py#L129">
      
      (source)
    </a>
  </div>
  <div class="docstring functionBody">
    
    
    <div><p>Prepares an <code><a href="sqlalchemy.ext.orderinglist.OrderingList.html" class="internal-link" title="sqlalchemy.ext.orderinglist.OrderingList">OrderingList</a></code> factory for use in mapper definitions.</p>
<p>Returns an object suitable for use as an argument to a Mapper
relationship's <tt class="rst-docutils literal">collection_class</tt> option.  e.g.:</p>
<pre class="rst-literal-block">
from sqlalchemy.ext.orderinglist import ordering_list

class Slide(Base):
    __tablename__ = 'slide'

    id = Column(Integer, primary_key=True)
    name = Column(String)

    bullets = relationship("Bullet", order_by="Bullet.position",
                            collection_class=ordering_list('position'))
</pre>
<p>Additional arguments are passed to the <code>.OrderingList</code> constructor.</p>
<table class="fieldTable"><tr class="fieldStart"><td class="fieldName" colspan="2">Parameters</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">attr</span></td><td class="fieldArgDesc">Name of the mapped attribute to use for storage and retrieval of
ordering information</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">count​_from</span></td><td class="fieldArgDesc">Set up an integer-based ordering, starting at <tt class="rst-docutils literal">count_from</tt>.  For
example, <tt class="rst-docutils literal"><span class="pre">ordering_list('pos',</span> count_from=1)</tt> would create a 1-based
list in SQL, storing the value in the 'pos' column.  Ignored if
<tt class="rst-docutils literal">ordering_func</tt> is supplied.</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">**kw</span></td><td class="fieldArgDesc"><span class="undocumented">Undocumented</span></td></tr></table></div>
  </div>
</div><div class="basefunction private">
  
  
  <a name="sqlalchemy.ext.orderinglist._reconstitute">
    
  </a>
  <a name="_reconstitute">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">_reconstitute</span>(cls, dict_, items):
    <a class="sourceLink" href="https://github.com/pydocbrowser/pydocbrowser.github.io/tree/main/build/sources/sqlalchemy-1.4.31//lib/sqlalchemy/ext/orderinglist.py#L378">
      
      (source)
    </a>
  </div>
  <div class="docstring functionBody">
    
    
    <div><p>Reconstitute an <code>.OrderingList</code>.</p>
<p>This is the adjoint to <code>.OrderingList.__reduce__</code>.  It is used for
unpickling <code>.OrderingList</code> objects.</p>
</div>
  </div>
</div><div class="basefunction private">
  
  
  <a name="sqlalchemy.ext.orderinglist._unsugar_count_from">
    
  </a>
  <a name="_unsugar_count_from">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">_unsugar_count_from</span>(**kw):
    <a class="sourceLink" href="https://github.com/pydocbrowser/pydocbrowser.github.io/tree/main/build/sources/sqlalchemy-1.4.31//lib/sqlalchemy/ext/orderinglist.py#L192">
      
      (source)
    </a>
  </div>
  <div class="docstring functionBody">
    
    
    <div><p>Builds counting functions from keyword arguments.</p>
<p>Keyword argument filter, prepares a simple <tt class="rst-docutils literal">ordering_func</tt> from a
<tt class="rst-docutils literal">count_from</tt> argument, otherwise passes <tt class="rst-docutils literal">ordering_func</tt> on unchanged.</p>
</div>
  </div>
</div>

      </div>
    </div>

    <footer class="navbar navbar-default">
  
  <div class="container">
    <a href="index.html">API Documentation</a> for sqlalchemy,
  generated by <a href="https://github.com/twisted/pydoctor/">pydoctor</a>
    22.2.0 at 2022-02-23 08:22:50.
  </div>
</footer>

    <script src="pydoctor.js" type="text/javascript"></script>

  </body>
</html>