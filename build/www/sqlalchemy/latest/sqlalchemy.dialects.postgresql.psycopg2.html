<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
          "DTD/xhtml1-strict.dtd">
<html>
  

  <head>
    
    <title>sqlalchemy.dialects.postgresql.psycopg2</title>
    <meta name="generator" content="pydoctor 22.2.0"> 
        
    </meta>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=0.75" />
    <link rel="stylesheet" type="text/css" href="bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="apidocs.css" />
    <link rel="stylesheet" type="text/css" href="extra.css" />
</head>

  <body>

    

    <nav class="navbar navbar-default">
  
  <div class="container">

    <div class="navbar-header">
      
      <div class="navlinks">
          <span class="navbar-brand">
            sqlalchemy <a href="index.html">API Documentation</a>
          </span>

          <a href="moduleIndex.html">
            Modules
          </a>

          <a href="classIndex.html">
            Classes
          </a>

          <a href="nameIndex.html">
            Names
          </a>
      </div>

    </div>
  </div>
</nav>

    

    <div class="container">

      <div class="page-header">
        <h1 class="module"><code><code><a href="index.html" class="internal-link">sqlalchemy</a></code><wbr></wbr>.<code><a href="sqlalchemy.dialects.html" class="internal-link" title="sqlalchemy.dialects">dialects</a></code><wbr></wbr>.<code><a href="sqlalchemy.dialects.postgresql.html" class="internal-link" title="sqlalchemy.dialects.postgresql">postgresql</a></code><wbr></wbr>.<code><a href="sqlalchemy.dialects.postgresql.psycopg2.html" class="internal-link" title="sqlalchemy.dialects.postgresql.psycopg2">psycopg2</a></code></code></h1>
        <div id="showPrivate">
          <button class="btn btn-link" onclick="togglePrivate()">Toggle Private API</button>
        </div>
      </div>

      <div class="categoryHeader">
        module documentation
      </div>

      <div class="extrasDocstring">
        
        <p></p>
      </div>

      <div class="moduleDocstring">
        <div><div class="rst-section" id="rst-psycopg2-connect-arguments">
<h2 class="heading">psycopg2 Connect Arguments</h2>
<p>Keyword arguments that are specific to the SQLAlchemy psycopg2 dialect
may be passed to <code>_sa.create_engine()</code>, and include the following:</p>
<ul>
<li><p class="rst-first"><tt class="rst-docutils literal">isolation_level</tt>: This option, available for all PostgreSQL dialects,
includes the <tt class="rst-docutils literal">AUTOCOMMIT</tt> isolation level when using the psycopg2
dialect.   This option sets the <strong>default</strong> isolation level for the
connection that is set immediately upon connection to the database before
the connection is pooled.  This option is generally superseded by the more
modern <a href="#system-message-1"><span class="rst-problematic" id="rst-problematic-1">:paramref:`_engine.Connection.execution_options.isolation_level`</span></a>
execution option, detailed at <a href="#system-message-2"><span class="rst-problematic" id="rst-problematic-2">:ref:`dbapi_autocommit`</span></a>.</p>
<div class="rst-admonition seealso">
<p class="rst-first rst-admonition-title">See Also</p>
<p><a href="#system-message-3"><span class="rst-problematic" id="rst-problematic-3">:ref:`psycopg2_isolation_level`</span></a></p>
<p class="rst-last"><a href="#system-message-4"><span class="rst-problematic" id="rst-problematic-4">:ref:`dbapi_autocommit`</span></a></p>
</div>
</li>
<li><p class="rst-first"><tt class="rst-docutils literal">client_encoding</tt>: sets the client encoding in a libpq-agnostic way,
using psycopg2's <tt class="rst-docutils literal">set_client_encoding()</tt> method.</p>
<div class="rst-admonition seealso">
<p class="rst-first rst-admonition-title">See Also</p>
<p class="rst-last"><a href="#system-message-5"><span class="rst-problematic" id="rst-problematic-5">:ref:`psycopg2_unicode`</span></a></p>
</div>
</li>
<li><p class="rst-first"><tt class="rst-docutils literal">use_native_unicode</tt>: Under Python 2 only, this can be set to False to
disable the use of psycopg2's native Unicode support.</p>
<div class="rst-admonition seealso">
<p class="rst-first rst-admonition-title">See Also</p>
<p class="rst-last"><a href="#system-message-6"><span class="rst-problematic" id="rst-problematic-6">:ref:`psycopg2_disable_native_unicode`</span></a></p>
</div>
</li>
<li><p class="rst-first"><tt class="rst-docutils literal">executemany_mode</tt>, <tt class="rst-docutils literal">executemany_batch_page_size</tt>,
<tt class="rst-docutils literal">executemany_values_page_size</tt>: Allows use of psycopg2
extensions for optimizing "executemany"-style queries.  See the referenced
section below for details.</p>
<div class="rst-admonition seealso">
<p class="rst-first rst-admonition-title">See Also</p>
<p class="rst-last"><a href="#system-message-7"><span class="rst-problematic" id="rst-problematic-7">:ref:`psycopg2_executemany_mode`</span></a></p>
</div>
</li>
</ul>
<div class="rst-admonition tip">
<p class="rst-first rst-admonition-title">Tip</p>
<p>The above keyword arguments are <strong>dialect</strong> keyword arguments, meaning
that they are passed as explicit keyword arguments to <code>_sa.create_engine()</code>:</p>
<pre class="rst-literal-block">
engine = create_engine(
    "postgresql+psycopg2://scott:tiger@localhost/test",
    isolation_level="SERIALIZABLE",
)
</pre>
<p class="rst-last">These should not be confused with <strong>DBAPI</strong> connect arguments, which
are passed as part of the <a href="#system-message-8"><span class="rst-problematic" id="rst-problematic-8">:paramref:`_sa.create_engine.connect_args`</span></a>
dictionary and/or are passed in the URL query string, as detailed in
the section <a href="#system-message-9"><span class="rst-problematic" id="rst-problematic-9">:ref:`custom_dbapi_args`</span></a>.</p>
</div>
</div>
<div class="rst-section" id="rst-ssl-connections">
<span id="rst-psycopg2-ssl"></span><h2 class="heading">SSL Connections</h2>
<p>The psycopg2 module has a connection argument named <tt class="rst-docutils literal">sslmode</tt> for
controlling its behavior regarding secure (SSL) connections. The default is
<tt class="rst-docutils literal">sslmode=prefer</tt>; it will attempt an SSL connection and if that fails it
will fall back to an unencrypted connection. <tt class="rst-docutils literal">sslmode=require</tt> may be used
to ensure that only secure connections are established.  Consult the
psycopg2 / libpq documentation for further options that are available.</p>
<p>Note that <tt class="rst-docutils literal">sslmode</tt> is specific to psycopg2 so it is included in the
connection URI:</p>
<pre class="rst-literal-block">
engine = sa.create_engine(
    "postgresql+psycopg2://scott:tiger@192.168.0.199:5432/test?sslmode=require"
)
</pre>
</div>
<div class="rst-section" id="rst-unix-domain-connections">
<h2 class="heading">Unix Domain Connections</h2>
<p>psycopg2 supports connecting via Unix domain connections.   When the <tt class="rst-docutils literal">host</tt>
portion of the URL is omitted, SQLAlchemy passes <tt class="rst-docutils literal">None</tt> to psycopg2,
which specifies Unix-domain communication rather than TCP/IP communication:</p>
<pre class="rst-literal-block">
create_engine("postgresql+psycopg2://user:password@/dbname")
</pre>
<p>By default, the socket file used is to connect to a Unix-domain socket
in <tt class="rst-docutils literal">/tmp</tt>, or whatever socket directory was specified when PostgreSQL
was built.  This value can be overridden by passing a pathname to psycopg2,
using <tt class="rst-docutils literal">host</tt> as an additional keyword argument:</p>
<pre class="rst-literal-block">
create_engine("postgresql+psycopg2://user:password@/dbname?host=/var/lib/postgresql")
</pre>
<div class="rst-admonition seealso">
<p class="rst-first rst-admonition-title">See Also</p>
<p class="rst-last"><a class="rst-reference external" href="https://www.postgresql.org/docs/9.1/static/libpq-connect.html#LIBPQ-PQCONNECTDBPARAMS" target="_top">PQconnectdbParams </a></p>
</div>
</div>
<div class="rst-section" id="rst-specifying-multiple-fallback-hosts">
<span id="rst-psycopg2-multi-host"></span><h2 class="heading">Specifying multiple fallback hosts</h2>
<p>psycopg2 supports multiple connection points in the connection string.
When the <tt class="rst-docutils literal">host</tt> parameter is used multiple times in the query section of
the URL, SQLAlchemy will create a single string of the host and port
information provided to make the connections:</p>
<pre class="rst-literal-block">
create_engine(
    "postgresql+psycopg2://user:password@/dbname?host=HostA:port1&amp;host=HostB&amp;host=HostC"
)
</pre>
<p>A connection to each host is then attempted until either a connection is successful
or all connections are unsuccessful in which case an error is raised.</p>
<div class="rst-versionadded">
<span class="rst-versionmodified rst-added">New in version 1.3.20: </span><span>Support for multiple hosts in PostgreSQL connection
string.</span></div>
<div class="rst-admonition seealso">
<p class="rst-first rst-admonition-title">See Also</p>
<p class="rst-last"><a class="rst-reference external" href="https://www.postgresql.org/docs/10/libpq-connect.html#LIBPQ-CONNSTRING" target="_top">PQConnString </a></p>
</div>
</div>
<div class="rst-section" id="rst-empty-dsn-connections-environment-variable-connections">
<h2 class="heading">Empty DSN Connections / Environment Variable Connections</h2>
<p>The psycopg2 DBAPI can connect to PostgreSQL by passing an empty DSN to the
libpq client library, which by default indicates to connect to a localhost
PostgreSQL database that is open for "trust" connections.  This behavior can be
further tailored using a particular set of environment variables which are
prefixed with <tt class="rst-docutils literal"><span class="pre">PG_...</span></tt>, which are  consumed by <tt class="rst-docutils literal">libpq</tt> to take the place of
any or all elements of the connection string.</p>
<p>For this form, the URL can be passed without any elements other than the
initial scheme:</p>
<pre class="rst-literal-block">
engine = create_engine('postgresql+psycopg2://')
</pre>
<p>In the above form, a blank "dsn" string is passed to the <tt class="rst-docutils literal">psycopg2.connect()</tt>
function which in turn represents an empty DSN passed to libpq.</p>
<div class="rst-versionadded">
<span class="rst-versionmodified rst-added">New in version 1.3.2: </span><span>support for parameter-less connections with psycopg2.</span></div>
<div class="rst-admonition seealso">
<p class="rst-first rst-admonition-title">See Also</p>
<p class="rst-last"><a class="rst-reference external" href="https://www.postgresql.org/docs/current/libpq-envars.html" target="_top">Environment Variables</a> -
PostgreSQL documentation on how to use <tt class="rst-docutils literal"><span class="pre">PG_...</span></tt>
environment variables for connections.</p>
</div>
</div>
<div class="rst-section" id="rst-per-statement-connection-execution-options">
<span id="rst-psycopg2-execution-options"></span><h2 class="heading">Per-Statement/Connection Execution Options</h2>
<p>The following DBAPI-specific options are respected when used with
<code>_engine.Connection.execution_options</code>,
<code>.Executable.execution_options</code>,
<code>_query.Query.execution_options</code>,
in addition to those not specific to DBAPIs:</p>
<ul>
<li><p class="rst-first"><tt class="rst-docutils literal">isolation_level</tt> - Set the transaction isolation level for the lifespan
of a <code>_engine.Connection</code> (can only be set on a connection,
not a statement
or query).   See <a href="#system-message-10"><span class="rst-problematic" id="rst-problematic-10">:ref:`psycopg2_isolation_level`</span></a>.</p>
</li>
<li><p class="rst-first"><tt class="rst-docutils literal">stream_results</tt> - Enable or disable usage of psycopg2 server side
cursors - this feature makes use of "named" cursors in combination with
special result handling methods so that result rows are not fully buffered.
Defaults to False, meaning cursors are buffered by default.</p>
</li>
<li><p class="rst-first"><tt class="rst-docutils literal">max_row_buffer</tt> - when using <tt class="rst-docutils literal">stream_results</tt>, an integer value that
specifies the maximum number of rows to buffer at a time.  This is
interpreted by the <code>.BufferedRowCursorResult</code>, and if omitted the
buffer will grow to ultimately store 1000 rows at a time.</p>
<div class="rst-versionchanged">
<p><span class="rst-versionmodified rst-changed">Changed in version 1.4: </span><span>The <tt class="rst-docutils literal">max_row_buffer</tt> size can now be greater than
1000, and the buffer will grow to that size.</span></p>
</div>
</li>
</ul>
</div>
<div class="rst-section" id="rst-psycopg2-fast-execution-helpers">
<span id="rst-psycopg2-executemany-mode"></span><span id="rst-psycopg2-batch-mode"></span><h2 class="heading">Psycopg2 Fast Execution Helpers</h2>
<p>Modern versions of psycopg2 include a feature known as
<a class="rst-reference external" href="https://initd.org/psycopg/docs/extras.html#fast-execution-helpers" target="_top">Fast Execution Helpers </a>, which
have been shown in benchmarking to improve psycopg2's executemany()
performance, primarily with INSERT statements, by multiple orders of magnitude.
SQLAlchemy internally makes use of these extensions for <tt class="rst-docutils literal">executemany()</tt> style
calls, which correspond to lists of parameters being passed to
<code>_engine.Connection.execute</code> as detailed in <a href="#system-message-11"><span class="rst-problematic" id="rst-problematic-11">:ref:`multiple parameter
sets &lt;execute_multiple&gt;`</span></a>.   The ORM also uses this mode internally whenever
possible.</p>
<p>The two available extensions on the psycopg2 side are the <tt class="rst-docutils literal">execute_values()</tt>
and <tt class="rst-docutils literal">execute_batch()</tt> functions.  The psycopg2 dialect defaults to using the
<tt class="rst-docutils literal">execute_values()</tt> extension for all qualifying INSERT statements.</p>
<div class="rst-versionchanged">
<span class="rst-versionmodified rst-changed">Changed in version 1.4: </span><span>The psycopg2 dialect now defaults to a new mode
<tt class="rst-docutils literal">"values_only"</tt> for <tt class="rst-docutils literal">executemany_mode</tt>, which allows an order of
magnitude performance improvement for INSERT statements, but does not
include "batch" mode for UPDATE and DELETE statements which removes the
ability of <tt class="rst-docutils literal">cursor.rowcount</tt> to function correctly.</span></div>
<p>The use of these extensions is controlled by the <tt class="rst-docutils literal">executemany_mode</tt> flag
which may be passed to <code>_sa.create_engine</code>:</p>
<pre class="rst-literal-block">
engine = create_engine(
    "postgresql+psycopg2://scott:tiger@host/dbname",
    executemany_mode='values_plus_batch')
</pre>
<p>Possible options for <tt class="rst-docutils literal">executemany_mode</tt> include:</p>
<ul>
<li><p class="rst-first"><tt class="rst-docutils literal">values_only</tt> - this is the default value.  the psycopg2 execute_values()
extension is used for qualifying INSERT statements, which rewrites the INSERT
to include multiple VALUES clauses so that many parameter sets can be
inserted with one statement.</p>
<div class="rst-versionadded">
<p><span class="rst-versionmodified rst-added">New in version 1.4: </span><span>Added <tt class="rst-docutils literal">"values_only"</tt> setting for <tt class="rst-docutils literal">executemany_mode</tt>
which is also now the default.</span></p>
</div>
</li>
<li><p class="rst-first"><tt class="rst-docutils literal">None</tt> - No psycopg2 extensions are not used, and the usual
<tt class="rst-docutils literal">cursor.executemany()</tt> method is used when invoking statements with
multiple parameter sets.</p>
</li>
<li><p class="rst-first"><tt class="rst-docutils literal">'batch'</tt> - Uses <tt class="rst-docutils literal">psycopg2.extras.execute_batch</tt> for all qualifying
INSERT, UPDATE and DELETE statements, so that multiple copies
of a SQL query, each one corresponding to a parameter set passed to
<tt class="rst-docutils literal">executemany()</tt>, are joined into a single SQL string separated by a
semicolon.  When using this mode, the <code>_engine.CursorResult.rowcount</code>
attribute will not contain a value for executemany-style executions.</p>
</li>
<li><p class="rst-first"><tt class="rst-docutils literal">'values_plus_batch'</tt>- <tt class="rst-docutils literal">execute_values</tt> is used for qualifying INSERT
statements, <tt class="rst-docutils literal">execute_batch</tt> is used for UPDATE and DELETE.
When using this mode, the <code>_engine.CursorResult.rowcount</code>
attribute will not contain a value for executemany-style executions against
UPDATE and DELETE statements.</p>
</li>
</ul>
<p>By "qualifying statements", we mean that the statement being executed
must be a Core <code>_expression.insert</code>, <code>_expression.update</code>
or <code>_expression.delete</code> construct, and not a plain textual SQL
string or one constructed using <code>_expression.text</code>.  When using the
ORM, all insert/update/delete statements used by the ORM flush process
are qualifying.</p>
<p>The "page size" for the "values" and "batch" strategies can be affected
by using the <tt class="rst-docutils literal">executemany_batch_page_size</tt> and
<tt class="rst-docutils literal">executemany_values_page_size</tt> engine parameters.  These
control how many parameter sets
should be represented in each execution.    The "values" page size defaults
to 1000, which is different that psycopg2's default.  The "batch" page
size defaults to 100.  These can be affected by passing new values to
<code>_engine.create_engine</code>:</p>
<pre class="rst-literal-block">
engine = create_engine(
    "postgresql+psycopg2://scott:tiger@host/dbname",
    executemany_mode='values',
    executemany_values_page_size=10000, executemany_batch_page_size=500)
</pre>
<div class="rst-versionchanged">
<span class="rst-versionmodified rst-changed">Changed in version 1.4: </span><span>The default for <tt class="rst-docutils literal">executemany_values_page_size</tt> is now 1000, up from
100.</span></div>
<div class="rst-admonition seealso">
<p class="rst-first rst-admonition-title">See Also</p>
<p class="rst-last"><a href="#system-message-12"><span class="rst-problematic" id="rst-problematic-12">:ref:`execute_multiple`</span></a> - General information on using the
<code>_engine.Connection</code>
object to execute statements in such a way as to make
use of the DBAPI <tt class="rst-docutils literal">.executemany()</tt> method.</p>
</div>
</div>
<div class="rst-section" id="rst-unicode-with-psycopg2">
<span id="rst-psycopg2-unicode"></span><h2 class="heading">Unicode with Psycopg2</h2>
<p>The psycopg2 DBAPI driver supports Unicode data transparently.   Under Python 2
only, the SQLAlchemy psycopg2 dialect will enable the
<tt class="rst-docutils literal">psycopg2.extensions.UNICODE</tt> extension by default to ensure Unicode is
handled properly; under Python 3, this is psycopg2's default behavior.</p>
<p>The client character encoding can be controlled for the psycopg2 dialect
in the following ways:</p>
<ul>
<li><p class="rst-first">For PostgreSQL 9.1 and above, the <tt class="rst-docutils literal">client_encoding</tt> parameter may be
passed in the database URL; this parameter is consumed by the underlying
<tt class="rst-docutils literal">libpq</tt> PostgreSQL client library:</p>
<pre class="rst-literal-block">
engine = create_engine("postgresql+psycopg2://user:pass@host/dbname?client_encoding=utf8")
</pre>
<p>Alternatively, the above <tt class="rst-docutils literal">client_encoding</tt> value may be passed using
<a href="#system-message-13"><span class="rst-problematic" id="rst-problematic-13">:paramref:`_sa.create_engine.connect_args`</span></a> for programmatic establishment with
<tt class="rst-docutils literal">libpq</tt>:</p>
<pre class="rst-literal-block">
engine = create_engine(
    "postgresql+psycopg2://user:pass@host/dbname",
    connect_args={'client_encoding': 'utf8'}
)
</pre>
</li>
<li><p class="rst-first">For all PostgreSQL versions, psycopg2 supports a client-side encoding
value that will be passed to database connections when they are first
established.  The SQLAlchemy psycopg2 dialect supports this using the
<tt class="rst-docutils literal">client_encoding</tt> parameter passed to <code>_sa.create_engine</code>:</p>
<pre class="rst-literal-block">
engine = create_engine(
    "postgresql+psycopg2://user:pass@host/dbname",
    client_encoding="utf8"
)
</pre>
<div class="rst-admonition tip">
<p class="rst-first rst-admonition-title">Tip</p>
<p class="rst-last">The above <tt class="rst-docutils literal">client_encoding</tt> parameter admittedly is very similar
in appearance to usage of the parameter within the
<a href="#system-message-14"><span class="rst-problematic" id="rst-problematic-14">:paramref:`_sa.create_engine.connect_args`</span></a> dictionary; the difference
above is that the parameter is consumed by psycopg2 and is
passed to the database connection using <tt class="rst-docutils literal">SET client_encoding TO
'utf8'</tt>; in the previously mentioned style, the parameter is instead
passed through psycopg2 and consumed by the <tt class="rst-docutils literal">libpq</tt> library.</p>
</div>
</li>
<li><p class="rst-first">A common way to set up client encoding with PostgreSQL databases is to
ensure it is configured within the server-side postgresql.conf file;
this is the recommended way to set encoding for a server that is
consistently of one encoding in all databases:</p>
<pre class="rst-literal-block">
# postgresql.conf file

# client_encoding = sql_ascii # actually, defaults to database
                             # encoding
client_encoding = utf8
</pre>
</li>
</ul>
<div class="rst-section" id="rst-disabling-native-unicode">
<span id="rst-psycopg2-disable-native-unicode"></span><h3 class="heading">Disabling Native Unicode</h3>
<p>Under Python 2 only, SQLAlchemy can also be instructed to skip the usage of the
psycopg2 <tt class="rst-docutils literal">UNICODE</tt> extension and to instead utilize its own unicode
encode/decode services, which are normally reserved only for those DBAPIs that
don't fully support unicode directly.  Passing <tt class="rst-docutils literal">use_native_unicode=False</tt> to
<code>_sa.create_engine</code> will disable usage of <tt class="rst-docutils literal">psycopg2.extensions.
UNICODE</tt>. SQLAlchemy will instead encode data itself into Python bytestrings
on the way in and coerce from bytes on the way back, using the value of the
<code>_sa.create_engine</code> <tt class="rst-docutils literal">encoding</tt> parameter, which defaults to <tt class="rst-docutils literal"><span class="pre">utf-8</span></tt>.
SQLAlchemy's own unicode encode/decode functionality is steadily becoming
obsolete as most DBAPIs now support unicode fully.</p>
</div>
</div>
<div class="rst-section" id="rst-transactions">
<h2 class="heading">Transactions</h2>
<p>The psycopg2 dialect fully supports SAVEPOINT and two-phase commit operations.</p>
</div>
<div class="rst-section" id="rst-psycopg2-transaction-isolation-level">
<span id="rst-psycopg2-isolation-level"></span><h2 class="heading">Psycopg2 Transaction Isolation Level</h2>
<p>As discussed in <a href="#system-message-15"><span class="rst-problematic" id="rst-problematic-15">:ref:`postgresql_isolation_level`</span></a>,
all PostgreSQL dialects support setting of transaction isolation level
both via the <tt class="rst-docutils literal">isolation_level</tt> parameter passed to <code>_sa.create_engine</code>
,
as well as the <tt class="rst-docutils literal">isolation_level</tt> argument used by
<code>_engine.Connection.execution_options</code>.  When using the psycopg2 dialect
, these
options make use of psycopg2's <tt class="rst-docutils literal">set_isolation_level()</tt> connection method,
rather than emitting a PostgreSQL directive; this is because psycopg2's
API-level setting is always emitted at the start of each transaction in any
case.</p>
<p>The psycopg2 dialect supports these constants for isolation level:</p>
<ul class="rst-simple">
<li><tt class="rst-docutils literal">READ COMMITTED</tt></li>
<li><tt class="rst-docutils literal">READ UNCOMMITTED</tt></li>
<li><tt class="rst-docutils literal">REPEATABLE READ</tt></li>
<li><tt class="rst-docutils literal">SERIALIZABLE</tt></li>
<li><tt class="rst-docutils literal">AUTOCOMMIT</tt></li>
</ul>
<div class="rst-admonition seealso">
<p class="rst-first rst-admonition-title">See Also</p>
<p><a href="#system-message-16"><span class="rst-problematic" id="rst-problematic-16">:ref:`postgresql_isolation_level`</span></a></p>
<p class="rst-last"><a href="#system-message-17"><span class="rst-problematic" id="rst-problematic-17">:ref:`pg8000_isolation_level`</span></a></p>
</div>
</div>
<div class="rst-section" id="rst-notice-logging">
<h2 class="heading">NOTICE logging</h2>
<p>The psycopg2 dialect will log PostgreSQL NOTICE messages
via the <tt class="rst-docutils literal">sqlalchemy.dialects.postgresql</tt> logger.  When this logger
is set to the <tt class="rst-docutils literal">logging.INFO</tt> level, notice messages will be logged:</p>
<pre class="rst-literal-block">
import logging

logging.getLogger('sqlalchemy.dialects.postgresql').setLevel(logging.INFO)
</pre>
<p>Above, it is assumed that logging is configured externally.  If this is not
the case, configuration such as <tt class="rst-docutils literal">logging.basicConfig()</tt> must be utilized:</p>
<pre class="rst-literal-block">
import logging

logging.basicConfig()   # log messages to stdout
logging.getLogger('sqlalchemy.dialects.postgresql').setLevel(logging.INFO)
</pre>
<div class="rst-admonition seealso">
<p class="rst-first rst-admonition-title">See Also</p>
<p class="rst-last"><a class="rst-reference external" href="https://docs.python.org/3/howto/logging.html" target="_top">Logging HOWTO</a> - on the python.org website</p>
</div>
</div>
<div class="rst-section" id="rst-hstore-type">
<span id="rst-psycopg2-hstore"></span><h2 class="heading">HSTORE type</h2>
<p>The <tt class="rst-docutils literal">psycopg2</tt> DBAPI includes an extension to natively handle marshalling of
the HSTORE type.   The SQLAlchemy psycopg2 dialect will enable this extension
by default when psycopg2 version 2.4 or greater is used, and
it is detected that the target database has the HSTORE type set up for use.
In other words, when the dialect makes the first
connection, a sequence like the following is performed:</p>
<ol class="rst-arabic simple">
<li>Request the available HSTORE oids using
<tt class="rst-docutils literal">psycopg2.extras.HstoreAdapter.get_oids()</tt>.
If this function returns a list of HSTORE identifiers, we then determine
that the <tt class="rst-docutils literal">HSTORE</tt> extension is present.
This function is <strong>skipped</strong> if the version of psycopg2 installed is
less than version 2.4.</li>
<li>If the <tt class="rst-docutils literal">use_native_hstore</tt> flag is at its default of <tt class="rst-docutils literal">True</tt>, and
we've detected that <tt class="rst-docutils literal">HSTORE</tt> oids are available, the
<tt class="rst-docutils literal">psycopg2.extensions.register_hstore()</tt> extension is invoked for all
connections.</li>
</ol>
<p>The <tt class="rst-docutils literal">register_hstore()</tt> extension has the effect of <strong>all Python
dictionaries being accepted as parameters regardless of the type of target
column in SQL</strong>. The dictionaries are converted by this extension into a
textual HSTORE expression.  If this behavior is not desired, disable the
use of the hstore extension by setting <tt class="rst-docutils literal">use_native_hstore</tt> to <tt class="rst-docutils literal">False</tt> as
follows:</p>
<pre class="rst-literal-block">
engine = create_engine("postgresql+psycopg2://scott:tiger@localhost/test",
            use_native_hstore=False)
</pre>
<p>The <tt class="rst-docutils literal">HSTORE</tt> type is <strong>still supported</strong> when the
<tt class="rst-docutils literal">psycopg2.extensions.register_hstore()</tt> extension is not used.  It merely
means that the coercion between Python dictionaries and the HSTORE
string format, on both the parameter side and the result side, will take
place within SQLAlchemy's own marshalling logic, and not that of <tt class="rst-docutils literal">psycopg2</tt>
which may be more performant.</p>
</div>
</div>
      </div>

      <div id="splitTables">
        <table class="children sortable" id="id15670">
  
  
  <tr class="class">
    
    <td>Class</td>
    <td><code><a href="sqlalchemy.dialects.postgresql.psycopg2.PGCompiler_psycopg2.html" class="internal-link" title="sqlalchemy.dialects.postgresql.psycopg2.PGCompiler_psycopg2">​PGCompiler_psycopg2</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><code><a href="sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2.html" class="internal-link" title="sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2">​PGDialect_psycopg2</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><code><a href="sqlalchemy.dialects.postgresql.psycopg2.PGExecutionContext_psycopg2.html" class="internal-link" title="sqlalchemy.dialects.postgresql.psycopg2.PGExecutionContext_psycopg2">​PGExecution​Context_psycopg2</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><code><a href="sqlalchemy.dialects.postgresql.psycopg2.PGIdentifierPreparer_psycopg2.html" class="internal-link" title="sqlalchemy.dialects.postgresql.psycopg2.PGIdentifierPreparer_psycopg2">​PGIdentifier​Preparer_psycopg2</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="constant">
    
    <td>Constant</td>
    <td><code><a href="#EXECUTEMANY_BATCH" class="internal-link" title="sqlalchemy.dialects.postgresql.psycopg2.EXECUTEMANY_BATCH">EXECUTEMANY​_BATCH</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="constant">
    
    <td>Constant</td>
    <td><code><a href="#EXECUTEMANY_PLAIN" class="internal-link" title="sqlalchemy.dialects.postgresql.psycopg2.EXECUTEMANY_PLAIN">EXECUTEMANY​_PLAIN</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="constant">
    
    <td>Constant</td>
    <td><code><a href="#EXECUTEMANY_VALUES" class="internal-link" title="sqlalchemy.dialects.postgresql.psycopg2.EXECUTEMANY_VALUES">EXECUTEMANY​_VALUES</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="constant">
    
    <td>Constant</td>
    <td><code><a href="#EXECUTEMANY_VALUES_PLUS_BATCH" class="internal-link" title="sqlalchemy.dialects.postgresql.psycopg2.EXECUTEMANY_VALUES_PLUS_BATCH">EXECUTEMANY​_VALUES​_PLUS​_BATCH</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="variable">
    
    <td>Variable</td>
    <td><code><a href="#logger" class="internal-link" title="sqlalchemy.dialects.postgresql.psycopg2.logger">logger</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="class private">
    
    <td>Class</td>
    <td><code><a href="sqlalchemy.dialects.postgresql.psycopg2._PGARRAY.html" class="internal-link" title="sqlalchemy.dialects.postgresql.psycopg2._PGARRAY">​_PGARRAY</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="class private">
    
    <td>Class</td>
    <td><code><a href="sqlalchemy.dialects.postgresql.psycopg2._PGEnum.html" class="internal-link" title="sqlalchemy.dialects.postgresql.psycopg2._PGEnum">_​PGEnum</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="class private">
    
    <td>Class</td>
    <td><code><a href="sqlalchemy.dialects.postgresql.psycopg2._PGHStore.html" class="internal-link" title="sqlalchemy.dialects.postgresql.psycopg2._PGHStore">_​PGHStore</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="class private">
    
    <td>Class</td>
    <td><code><a href="sqlalchemy.dialects.postgresql.psycopg2._PGJSON.html" class="internal-link" title="sqlalchemy.dialects.postgresql.psycopg2._PGJSON">​_PGJSON</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="class private">
    
    <td>Class</td>
    <td><code><a href="sqlalchemy.dialects.postgresql.psycopg2._PGJSONB.html" class="internal-link" title="sqlalchemy.dialects.postgresql.psycopg2._PGJSONB">​_PGJSONB</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="class private">
    
    <td>Class</td>
    <td><code><a href="sqlalchemy.dialects.postgresql.psycopg2._PGNumeric.html" class="internal-link" title="sqlalchemy.dialects.postgresql.psycopg2._PGNumeric">_​PGNumeric</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="class private">
    
    <td>Class</td>
    <td><code><a href="sqlalchemy.dialects.postgresql.psycopg2._PGUUID.html" class="internal-link" title="sqlalchemy.dialects.postgresql.psycopg2._PGUUID">​_PGUUID</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="variable private">
    
    <td>Variable</td>
    <td><code><a href="#_server_side_id" class="internal-link" title="sqlalchemy.dialects.postgresql.psycopg2._server_side_id">​_server​_side​_id</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr>
</table>
        

          
      </div>

      <div id="childList">

        <div class="baseconstant">
  
  
  <a name="sqlalchemy.dialects.postgresql.psycopg2.EXECUTEMANY_BATCH">
    
  </a>
  <a name="EXECUTEMANY_BATCH">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">EXECUTEMANY_BATCH</span> =
    
  </div>
  <div class="functionBody">
    
    
    <div><p class="undocumented">Undocumented</p></div>
    <table class="valueTable"><tr class="fieldStart"><td class="fieldName">Value</td></tr><tr><td><pre class="constant-value"><code><a href="sqlalchemy.util.langhelpers.symbol.html" class="internal-link" title="sqlalchemy.util.langhelpers.symbol">util.symbol</a>(<wbr></wbr><span class="rst-variable-quote">'</span><span class="rst-variable-string">executemany_batch</span><span class="rst-variable-quote">'</span>,
            <wbr></wbr>canonical=1)</code></pre></td></tr></table>
  </div>
</div><div class="baseconstant">
  
  
  <a name="sqlalchemy.dialects.postgresql.psycopg2.EXECUTEMANY_PLAIN">
    
  </a>
  <a name="EXECUTEMANY_PLAIN">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">EXECUTEMANY_PLAIN</span> =
    
  </div>
  <div class="functionBody">
    
    
    <div><p class="undocumented">Undocumented</p></div>
    <table class="valueTable"><tr class="fieldStart"><td class="fieldName">Value</td></tr><tr><td><pre class="constant-value"><code><a href="sqlalchemy.util.langhelpers.symbol.html" class="internal-link" title="sqlalchemy.util.langhelpers.symbol">util.symbol</a>(<wbr></wbr><span class="rst-variable-quote">'</span><span class="rst-variable-string">executemany_plain</span><span class="rst-variable-quote">'</span>,
            <wbr></wbr>canonical=0)</code></pre></td></tr></table>
  </div>
</div><div class="baseconstant">
  
  
  <a name="sqlalchemy.dialects.postgresql.psycopg2.EXECUTEMANY_VALUES">
    
  </a>
  <a name="EXECUTEMANY_VALUES">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">EXECUTEMANY_VALUES</span> =
    
  </div>
  <div class="functionBody">
    
    
    <div><p class="undocumented">Undocumented</p></div>
    <table class="valueTable"><tr class="fieldStart"><td class="fieldName">Value</td></tr><tr><td><pre class="constant-value"><code><a href="sqlalchemy.util.langhelpers.symbol.html" class="internal-link" title="sqlalchemy.util.langhelpers.symbol">util.symbol</a>(<wbr></wbr><span class="rst-variable-quote">'</span><span class="rst-variable-string">executemany_values</span><span class="rst-variable-quote">'</span>,
            <wbr></wbr>canonical=2)</code></pre></td></tr></table>
  </div>
</div><div class="baseconstant">
  
  
  <a name="sqlalchemy.dialects.postgresql.psycopg2.EXECUTEMANY_VALUES_PLUS_BATCH">
    
  </a>
  <a name="EXECUTEMANY_VALUES_PLUS_BATCH">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">EXECUTEMANY_VALUES_PLUS_BATCH</span> =
    
  </div>
  <div class="functionBody">
    
    
    <div><p class="undocumented">Undocumented</p></div>
    <table class="valueTable"><tr class="fieldStart"><td class="fieldName">Value</td></tr><tr><td><pre class="constant-value"><code><a href="sqlalchemy.util.langhelpers.symbol.html" class="internal-link" title="sqlalchemy.util.langhelpers.symbol">util.symbol</a>(<wbr></wbr><span class="rst-variable-quote">'</span><span class="rst-variable-string">executemany_values_plus_batch</span><span class="rst-variable-quote">'</span>,
            <wbr></wbr>canonical=<a href="#EXECUTEMANY_BATCH" class="internal-link" title="sqlalchemy.dialects.postgresql.psycopg2.EXECUTEMANY_BATCH">EXECUTEMANY_BATCH</a>|<a href="#EXECUTEMANY_VALUES" class="internal-link" title="sqlalchemy.dialects.postgresql.psycopg2.EXECUTEMANY_VALUES">EXECUTEMANY_VALUES</a>)</code></pre></td></tr></table>
  </div>
</div><div class="basevariable">
  
  
  <a name="sqlalchemy.dialects.postgresql.psycopg2.logger">
    
  </a>
  <a name="logger">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">logger</span> =
    
  </div>
  <div class="functionBody">
    
    
    <div><p class="undocumented">Undocumented</p></div>
    
  </div>
</div><div class="basevariable private">
  
  
  <a name="sqlalchemy.dialects.postgresql.psycopg2._server_side_id">
    
  </a>
  <a name="_server_side_id">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">_server_side_id</span> =
    
  </div>
  <div class="functionBody">
    
    
    <div><p class="undocumented">Undocumented</p></div>
    
  </div>
</div>

      </div>
    </div>

    <footer class="navbar navbar-default">
  
  <div class="container">
    <a href="index.html">API Documentation</a> for sqlalchemy,
  generated by <a href="https://github.com/twisted/pydoctor/">pydoctor</a>
    22.2.0 at 2022-02-23 04:41:59.
  </div>
</footer>

    <script src="pydoctor.js" type="text/javascript"></script>

  </body>
</html>