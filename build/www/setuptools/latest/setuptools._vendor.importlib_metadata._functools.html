<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
          "DTD/xhtml1-strict.dtd">
<html>
  

  <head>
    
    <title>setuptools._vendor.importlib_metadata._functools</title>
    <meta name="generator" content="pydoctor 22.2.0"> 
        
    </meta>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=0.75" />
    <link rel="stylesheet" type="text/css" href="bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="apidocs.css" />
    <link rel="stylesheet" type="text/css" href="extra.css" />
</head>

  <body>

    

    <nav class="navbar navbar-default">
  
  <div class="container">

    <div class="navbar-header">
      
      <div class="navlinks">
          <span class="navbar-brand">
            setuptools <a href="index.html">API Documentation</a>
          </span>

          <a href="moduleIndex.html">
            Modules
          </a>

          <a href="classIndex.html">
            Classes
          </a>

          <a href="nameIndex.html">
            Names
          </a>
      </div>

    </div>
  </div>
</nav>

    

    <div class="container">

      <div class="page-header">
        <h1 class="module private"><code><code><a href="index.html" class="internal-link">setuptools</a></code><wbr></wbr>.<code><a href="setuptools._vendor.html" class="internal-link" title="setuptools._vendor">_vendor</a></code><wbr></wbr>.<code><a href="setuptools._vendor.importlib_metadata.html" class="internal-link" title="setuptools._vendor.importlib_metadata">importlib_metadata</a></code><wbr></wbr>.<code><a href="setuptools._vendor.importlib_metadata._functools.html" class="internal-link" title="setuptools._vendor.importlib_metadata._functools">_functools</a></code></code></h1>
        <div id="showPrivate">
          <button class="btn btn-link" onclick="togglePrivate()">Toggle Private API</button>
        </div>
      </div>

      <div class="categoryHeader">
        module documentation
      </div>

      <div class="extrasDocstring">
        
        <p></p>
      </div>

      <div class="moduleDocstring">
        <div><p class="undocumented">Undocumented</p></div>
      </div>

      <div id="splitTables">
        <table class="children sortable" id="id11942">
  
  
  <tr class="function">
    
    <td>Function</td>
    <td><code><a href="#method_cache" class="internal-link" title="setuptools._vendor.importlib_metadata._functools.method_cache">method​_cache</a></code></td>
    <td>Wrap lru_cache to support storing the cache data in the object instances.</td>
  </tr><tr class="function">
    
    <td>Function</td>
    <td><code><a href="#pass_none" class="internal-link" title="setuptools._vendor.importlib_metadata._functools.pass_none">pass​_none</a></code></td>
    <td>Wrap func so it's not called if its first param is None</td>
  </tr>
</table>
        

          
      </div>

      <div id="childList">

        <div class="basefunction">
  
  
  <a name="setuptools._vendor.importlib_metadata._functools.method_cache">
    
  </a>
  <a name="method_cache">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">method_cache</span>(method, cache_wrapper=None):
    
  </div>
  <div class="docstring functionBody">
    
    
    <div><p>Wrap lru_cache to support storing the cache data in the object instances.</p>
<p>Abstracts the common paradigm where the method explicitly saves an
underscore-prefixed protected property on first call and returns that
subsequently.</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span><span class="py-keyword">class</span> <span class="py-defname">MyClass</span>:
<span class="py-more">... </span>    calls = 0
<span class="py-more">...</span>
<span class="py-more">... </span>    @method_cache
<span class="py-more">... </span>    <span class="py-keyword">def</span> <span class="py-defname">method</span>(self, value):
<span class="py-more">... </span>        self.calls += 1
<span class="py-more">... </span>        <span class="py-keyword">return</span> value</pre><pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>a = MyClass()
<span class="py-prompt">&gt;&gt;&gt; </span>a.method(3)
<span class="py-output">3</span>
<span class="py-prompt">&gt;&gt;&gt; </span><span class="py-keyword">for</span> x <span class="py-keyword">in</span> <span class="py-builtin">range</span>(75):
<span class="py-more">... </span>    res = a.method(x)
<span class="py-prompt">&gt;&gt;&gt; </span>a.calls
<span class="py-output">75</span>
</pre><p>Note that the apparent behavior will be exactly like that of lru_cache
except that the cache is stored on each instance, so values in one
instance will not flush values from another, and when an instance is
deleted, so are the cached values for that instance.</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>b = MyClass()
<span class="py-prompt">&gt;&gt;&gt; </span><span class="py-keyword">for</span> x <span class="py-keyword">in</span> <span class="py-builtin">range</span>(35):
<span class="py-more">... </span>    res = b.method(x)
<span class="py-prompt">&gt;&gt;&gt; </span>b.calls
<span class="py-output">35</span>
<span class="py-prompt">&gt;&gt;&gt; </span>a.method(0)
<span class="py-output">0</span>
<span class="py-prompt">&gt;&gt;&gt; </span>a.calls
<span class="py-output">75</span>
</pre><p>Note that if method had been decorated with <tt class="rst-docutils literal">functools.lru_cache()</tt>,
a.calls would have been 76 (due to the cached value of 0 having been
flushed by the 'b' instance).</p>
<p>Clear the cache with <tt class="rst-docutils literal">.cache_clear()</tt></p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>a.method.cache_clear()</pre><p>Same for a method that hasn't yet been called.</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>c = MyClass()
<span class="py-prompt">&gt;&gt;&gt; </span>c.method.cache_clear()</pre><p>Another cache wrapper may be supplied:</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>cache = functools.lru_cache(maxsize=2)
<span class="py-prompt">&gt;&gt;&gt; </span>MyClass.method2 = method_cache(<span class="py-keyword">lambda</span> self: 3, cache_wrapper=cache)
<span class="py-prompt">&gt;&gt;&gt; </span>a = MyClass()
<span class="py-prompt">&gt;&gt;&gt; </span>a.method2()
<span class="py-output">3</span>
</pre><p>Caution - do not subsequently wrap the method with another decorator, such
as <tt class="rst-docutils literal">@property</tt>, which changes the semantics of the function.</p>
<p>See also
<a class="rst-reference external" href="http://code.activestate.com/recipes/577452-a-memoize-decorator-for-instance-methods/" target="_top">http://code.activestate.com/recipes/577452-a-memoize-decorator-for-instance-methods/</a>
for another implementation and additional justification.</p>
</div>
  </div>
</div><div class="basefunction">
  
  
  <a name="setuptools._vendor.importlib_metadata._functools.pass_none">
    
  </a>
  <a name="pass_none">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">pass_none</span>(func):
    
  </div>
  <div class="docstring functionBody">
    
    
    <div><p>Wrap func so it's not called if its first param is None</p>
<pre class="py-doctest">
<span class="py-prompt">&gt;&gt;&gt; </span>print_text = pass_none(<span class="py-builtin">print</span>)
<span class="py-prompt">&gt;&gt;&gt; </span>print_text(<span class="py-string">'text'</span>)
<span class="py-output">text</span>
<span class="py-prompt">&gt;&gt;&gt; </span>print_text(<span class="py-builtin">None</span>)</pre></div>
  </div>
</div>

      </div>
    </div>

    <footer class="navbar navbar-default">
  
  <div class="container">
    <a href="index.html">API Documentation</a> for setuptools,
  generated by <a href="https://github.com/twisted/pydoctor/">pydoctor</a>
    22.2.0 at 2022-02-23 04:39:29.
  </div>
</footer>

    <script src="pydoctor.js" type="text/javascript"></script>

  </body>
</html>